2025-07-22 16:07:09,256 | INFO     | utils - Loading dataset splits from: data/dataset_splits.json
2025-07-22 16:07:09,256 | INFO     | utils - Could not load splits file. Reason: Splits file not found: data/dataset_splits.json. Generating new splits.
2025-07-22 16:07:09,256 | INFO     | utils - Generating new dataset splits...
2025-07-22 16:07:09,731 | INFO     | utils - Generated splits from 1000000 profiles across 10 files: train=700000 (70.0%), val=150000 (15.0%), test=150000 (15.0%)
2025-07-22 16:07:11,682 | INFO     | utils - Saved generated splits to models/trained_model/splits_generated.json
2025-07-22 16:07:11,683 | INFO     | preprocess - Configuration has changed or processed data not found. Starting preprocessing...
2025-07-22 16:07:11,683 | INFO     | hardware - Using CUDA device: NVIDIA A100 80GB PCIe
2025-07-22 16:07:11,684 | INFO     | normalizer - DataNormalizer initialized on device 'cuda'.
2025-07-22 16:07:11,684 | INFO     | normalizer - Starting statistics calculation from 700000 training samples...
2025-07-22 16:17:21,683 | INFO     | normalizer - Finished statistics calculation in 610.00s.
2025-07-22 16:17:21,683 | INFO     | normalizer - Approximating quantiles for 'pressure_bar' using sample of 10,000,000 values (out of 52,500,000 total).
2025-07-22 16:17:21,684 | INFO     | normalizer - Approximating quantiles for 'net_thermal_flux' using sample of 10,000,000 values (out of 52,500,000 total).
2025-07-22 16:17:22,914 | INFO     | normalizer - Approximating quantiles for 'net_reflected_flux' using sample of 10,000,000 values (out of 52,500,000 total).
2025-07-22 16:17:22,917 | INFO     | normalizer - Statistics calculation complete.
2025-07-22 16:17:22,923 | INFO     | preprocess - Normalization metadata computed and saved in 611.24s.
2025-07-22 16:17:22,923 | INFO     | preprocess - Using device: cuda for normalization.
2025-07-22 16:17:23,085 | INFO     | preprocess - Processing train split (700000 profiles)...
2025-07-22 16:27:31,654 | INFO     | preprocess - Completed train split in 608.73s.
2025-07-22 16:27:31,698 | INFO     | preprocess - Processing val split (150000 profiles)...
2025-07-22 16:29:34,360 | INFO     | preprocess - Completed val split in 122.71s.
2025-07-22 16:29:34,402 | INFO     | preprocess - Processing test split (150000 profiles)...
2025-07-22 16:31:37,185 | INFO     | preprocess - Completed test split in 122.83s.
2025-07-22 16:31:37,186 | INFO     | preprocess - Saving preprocessing summary to data/processed/preprocessing_summary.txt
2025-07-22 16:31:37,186 | INFO     | preprocess - Preprocessing completed successfully in 1465.50s.
2025-07-22 16:31:37,188 | INFO     | train - Detected A100 GPU - applying performance optimizations
2025-07-22 16:31:39,051 | INFO     | dataset - Creating dataset from data/processed/train...
2025-07-22 16:31:39,058 | INFO     | dataset - Memory estimate: 2.68 GB needed, 394.85 GB safely available
2025-07-22 16:31:39,058 | INFO     | dataset - Loading entire dataset into RAM...
2025-07-22 16:31:58,219 | INFO     | dataset - Loaded 10000/700000 samples into RAM
2025-07-22 16:32:17,371 | INFO     | dataset - Loaded 20000/700000 samples into RAM
2025-07-22 16:32:36,640 | INFO     | dataset - Loaded 30000/700000 samples into RAM
2025-07-22 16:32:55,589 | INFO     | dataset - Loaded 40000/700000 samples into RAM
2025-07-22 16:33:14,953 | INFO     | dataset - Loaded 50000/700000 samples into RAM
2025-07-22 16:33:34,179 | INFO     | dataset - Loaded 60000/700000 samples into RAM
2025-07-22 16:33:53,414 | INFO     | dataset - Loaded 70000/700000 samples into RAM
2025-07-22 16:34:12,803 | INFO     | dataset - Loaded 80000/700000 samples into RAM
2025-07-22 16:34:31,950 | INFO     | dataset - Loaded 90000/700000 samples into RAM
2025-07-22 16:34:51,055 | INFO     | dataset - Loaded 100000/700000 samples into RAM
2025-07-22 16:35:10,236 | INFO     | dataset - Loaded 110000/700000 samples into RAM
2025-07-22 16:35:29,528 | INFO     | dataset - Loaded 120000/700000 samples into RAM
2025-07-22 16:35:49,069 | INFO     | dataset - Loaded 130000/700000 samples into RAM
2025-07-22 16:36:08,542 | INFO     | dataset - Loaded 140000/700000 samples into RAM
2025-07-22 16:36:28,000 | INFO     | dataset - Loaded 150000/700000 samples into RAM
2025-07-22 16:36:47,360 | INFO     | dataset - Loaded 160000/700000 samples into RAM
2025-07-22 16:37:06,650 | INFO     | dataset - Loaded 170000/700000 samples into RAM
2025-07-22 16:37:26,076 | INFO     | dataset - Loaded 180000/700000 samples into RAM
2025-07-22 16:37:45,418 | INFO     | dataset - Loaded 190000/700000 samples into RAM
2025-07-22 16:38:04,990 | INFO     | dataset - Loaded 200000/700000 samples into RAM
2025-07-22 16:38:24,539 | INFO     | dataset - Loaded 210000/700000 samples into RAM
2025-07-22 16:38:44,011 | INFO     | dataset - Loaded 220000/700000 samples into RAM
2025-07-22 16:39:03,287 | INFO     | dataset - Loaded 230000/700000 samples into RAM
2025-07-22 16:39:22,828 | INFO     | dataset - Loaded 240000/700000 samples into RAM
2025-07-22 16:39:42,422 | INFO     | dataset - Loaded 250000/700000 samples into RAM
2025-07-22 16:40:01,930 | INFO     | dataset - Loaded 260000/700000 samples into RAM
2025-07-22 16:40:21,296 | INFO     | dataset - Loaded 270000/700000 samples into RAM
2025-07-22 16:40:40,638 | INFO     | dataset - Loaded 280000/700000 samples into RAM
2025-07-22 16:41:00,231 | INFO     | dataset - Loaded 290000/700000 samples into RAM
2025-07-22 16:41:19,606 | INFO     | dataset - Loaded 300000/700000 samples into RAM
2025-07-22 16:41:39,082 | INFO     | dataset - Loaded 310000/700000 samples into RAM
2025-07-22 16:41:58,467 | INFO     | dataset - Loaded 320000/700000 samples into RAM
2025-07-22 16:42:18,154 | INFO     | dataset - Loaded 330000/700000 samples into RAM
2025-07-22 16:42:37,749 | INFO     | dataset - Loaded 340000/700000 samples into RAM
2025-07-22 16:42:57,527 | INFO     | dataset - Loaded 350000/700000 samples into RAM
2025-07-22 16:43:17,041 | INFO     | dataset - Loaded 360000/700000 samples into RAM
2025-07-22 16:43:36,536 | INFO     | dataset - Loaded 370000/700000 samples into RAM
2025-07-22 16:43:56,114 | INFO     | dataset - Loaded 380000/700000 samples into RAM
2025-07-22 16:44:15,562 | INFO     | dataset - Loaded 390000/700000 samples into RAM
2025-07-22 16:44:35,061 | INFO     | dataset - Loaded 400000/700000 samples into RAM
2025-07-22 16:44:54,429 | INFO     | dataset - Loaded 410000/700000 samples into RAM
2025-07-22 16:45:13,811 | INFO     | dataset - Loaded 420000/700000 samples into RAM
2025-07-22 16:45:33,211 | INFO     | dataset - Loaded 430000/700000 samples into RAM
2025-07-22 16:45:52,657 | INFO     | dataset - Loaded 440000/700000 samples into RAM
2025-07-22 16:46:12,088 | INFO     | dataset - Loaded 450000/700000 samples into RAM
2025-07-22 16:46:31,482 | INFO     | dataset - Loaded 460000/700000 samples into RAM
2025-07-22 16:46:51,061 | INFO     | dataset - Loaded 470000/700000 samples into RAM
2025-07-22 16:47:10,579 | INFO     | dataset - Loaded 480000/700000 samples into RAM
2025-07-22 16:47:29,993 | INFO     | dataset - Loaded 490000/700000 samples into RAM
2025-07-22 16:47:49,495 | INFO     | dataset - Loaded 500000/700000 samples into RAM
2025-07-22 16:48:08,994 | INFO     | dataset - Loaded 510000/700000 samples into RAM
2025-07-22 16:48:28,488 | INFO     | dataset - Loaded 520000/700000 samples into RAM
2025-07-22 16:48:47,914 | INFO     | dataset - Loaded 530000/700000 samples into RAM
2025-07-22 16:49:07,488 | INFO     | dataset - Loaded 540000/700000 samples into RAM
2025-07-22 16:49:27,077 | INFO     | dataset - Loaded 550000/700000 samples into RAM
2025-07-22 16:49:46,539 | INFO     | dataset - Loaded 560000/700000 samples into RAM
2025-07-22 16:50:05,927 | INFO     | dataset - Loaded 570000/700000 samples into RAM
2025-07-22 16:50:25,679 | INFO     | dataset - Loaded 580000/700000 samples into RAM
2025-07-22 16:50:45,390 | INFO     | dataset - Loaded 590000/700000 samples into RAM
2025-07-22 16:51:04,657 | INFO     | dataset - Loaded 600000/700000 samples into RAM
2025-07-22 16:51:24,330 | INFO     | dataset - Loaded 610000/700000 samples into RAM
2025-07-22 16:51:43,982 | INFO     | dataset - Loaded 620000/700000 samples into RAM
2025-07-22 16:52:03,491 | INFO     | dataset - Loaded 630000/700000 samples into RAM
2025-07-22 16:52:23,117 | INFO     | dataset - Loaded 640000/700000 samples into RAM
2025-07-22 16:52:42,742 | INFO     | dataset - Loaded 650000/700000 samples into RAM
2025-07-22 16:53:02,277 | INFO     | dataset - Loaded 660000/700000 samples into RAM
2025-07-22 16:53:21,817 | INFO     | dataset - Loaded 670000/700000 samples into RAM
2025-07-22 16:53:41,369 | INFO     | dataset - Loaded 680000/700000 samples into RAM
2025-07-22 16:54:00,939 | INFO     | dataset - Loaded 690000/700000 samples into RAM
2025-07-22 16:54:20,473 | INFO     | dataset - Loaded 700000/700000 samples into RAM
2025-07-22 16:54:20,473 | INFO     | dataset - AtmosphericDataset initialized: 700000 samples from data/processed/train (mode: RAM)
2025-07-22 16:54:20,473 | INFO     | dataset - Creating dataset from data/processed/val...
2025-07-22 16:54:20,474 | INFO     | dataset - Memory estimate: 0.57 GB needed, 392.63 GB safely available
2025-07-22 16:54:20,474 | INFO     | dataset - Loading entire dataset into RAM...
2025-07-22 16:54:40,067 | INFO     | dataset - Loaded 10000/150000 samples into RAM
2025-07-22 16:54:59,591 | INFO     | dataset - Loaded 20000/150000 samples into RAM
2025-07-22 16:55:18,945 | INFO     | dataset - Loaded 30000/150000 samples into RAM
2025-07-22 16:55:38,434 | INFO     | dataset - Loaded 40000/150000 samples into RAM
2025-07-22 16:55:57,861 | INFO     | dataset - Loaded 50000/150000 samples into RAM
2025-07-22 16:56:17,563 | INFO     | dataset - Loaded 60000/150000 samples into RAM
2025-07-22 16:56:37,167 | INFO     | dataset - Loaded 70000/150000 samples into RAM
2025-07-22 16:56:56,469 | INFO     | dataset - Loaded 80000/150000 samples into RAM
2025-07-22 16:57:15,830 | INFO     | dataset - Loaded 90000/150000 samples into RAM
2025-07-22 16:57:36,162 | INFO     | dataset - Loaded 100000/150000 samples into RAM
2025-07-22 16:57:56,595 | INFO     | dataset - Loaded 110000/150000 samples into RAM
2025-07-22 16:58:17,051 | INFO     | dataset - Loaded 120000/150000 samples into RAM
2025-07-22 16:58:37,523 | INFO     | dataset - Loaded 130000/150000 samples into RAM
2025-07-22 16:58:57,991 | INFO     | dataset - Loaded 140000/150000 samples into RAM
2025-07-22 16:59:18,567 | INFO     | dataset - Loaded 150000/150000 samples into RAM
2025-07-22 16:59:18,568 | INFO     | dataset - AtmosphericDataset initialized: 150000 samples from data/processed/val (mode: RAM)
2025-07-22 16:59:18,568 | INFO     | dataset - Creating dataset from data/processed/test...
2025-07-22 16:59:18,569 | INFO     | dataset - Memory estimate: 0.57 GB needed, 392.18 GB safely available
2025-07-22 16:59:18,569 | INFO     | dataset - Loading entire dataset into RAM...
2025-07-22 16:59:39,325 | INFO     | dataset - Loaded 10000/150000 samples into RAM
2025-07-22 17:00:00,010 | INFO     | dataset - Loaded 20000/150000 samples into RAM
2025-07-22 17:00:20,630 | INFO     | dataset - Loaded 30000/150000 samples into RAM
2025-07-22 17:00:41,066 | INFO     | dataset - Loaded 40000/150000 samples into RAM
2025-07-22 17:01:01,581 | INFO     | dataset - Loaded 50000/150000 samples into RAM
2025-07-22 17:01:22,091 | INFO     | dataset - Loaded 60000/150000 samples into RAM
2025-07-22 17:01:42,469 | INFO     | dataset - Loaded 70000/150000 samples into RAM
2025-07-22 17:02:02,058 | INFO     | dataset - Loaded 80000/150000 samples into RAM
2025-07-22 17:02:21,797 | INFO     | dataset - Loaded 90000/150000 samples into RAM
2025-07-22 17:02:42,149 | INFO     | dataset - Loaded 100000/150000 samples into RAM
2025-07-22 17:03:02,580 | INFO     | dataset - Loaded 110000/150000 samples into RAM
2025-07-22 17:03:22,855 | INFO     | dataset - Loaded 120000/150000 samples into RAM
2025-07-22 17:03:43,213 | INFO     | dataset - Loaded 130000/150000 samples into RAM
2025-07-22 17:04:03,577 | INFO     | dataset - Loaded 140000/150000 samples into RAM
2025-07-22 17:04:24,023 | INFO     | dataset - Loaded 150000/150000 samples into RAM
2025-07-22 17:04:24,023 | INFO     | dataset - AtmosphericDataset initialized: 150000 samples from data/processed/test (mode: RAM)
2025-07-22 17:04:24,023 | INFO     | train - Datasets ready – train:700,000  val:150,000  test:150,000
2025-07-22 17:04:24,024 | INFO     | train - Using DevicePrefetchLoader for CUDA transfers
2025-07-22 17:04:24,085 | INFO     | model - PredictionModel created with 4,813,314 trainable parameters. Architecture: d_model=256, nhead=8, layers=6
2025-07-22 17:04:24,090 | INFO     | model - Attempting torch.compile with mode='default'
2025-07-22 17:04:26,880 | INFO     | model - Model compiled successfully
2025-07-22 17:04:26,880 | INFO     | model - Model moved to device: cuda
2025-07-22 17:04:26,881 | INFO     | train - Optimizer: adamw  lr=1.00e-04  wd=1.00e-05
2025-07-22 17:04:26,881 | INFO     | train - Using ReduceLROnPlateau scheduler.
2025-07-22 17:04:26,881 | INFO     | train - AMP enabled.
2025-07-22 17:04:26,881 | INFO     | train - Effective batch size: 256 (accumulation: 1)
2025-07-22 17:04:27,001 | INFO     | train - Training for 100 epochs.
2025-07-22 17:07:23,545 | INFO     | train - E001  train:nan  val:nan  lr:1.00e-04  t:176.5s
2025-07-22 17:09:23,851 | INFO     | train - E002  train:nan  val:nan  lr:1.00e-04  t:120.3s
2025-07-22 17:11:24,153 | INFO     | train - E003  train:nan  val:nan  lr:1.00e-04  t:120.3s
2025-07-22 17:13:24,519 | INFO     | train - E004  train:nan  val:nan  lr:5.00e-05  t:120.4s
2025-07-22 17:15:24,866 | INFO     | train - E005  train:nan  val:nan  lr:5.00e-05  t:120.3s
2025-07-22 17:17:25,223 | INFO     | train - E006  train:nan  val:nan  lr:5.00e-05  t:120.4s
2025-07-22 17:19:25,575 | INFO     | train - E007  train:nan  val:nan  lr:5.00e-05  t:120.4s
2025-07-22 17:21:25,872 | INFO     | train - E008  train:nan  val:nan  lr:2.50e-05  t:120.3s
2025-07-22 17:23:26,174 | INFO     | train - E009  train:nan  val:nan  lr:2.50e-05  t:120.3s
2025-07-22 17:25:26,512 | INFO     | train - E010  train:nan  val:nan  lr:2.50e-05  t:120.3s
2025-07-22 17:27:26,854 | INFO     | train - E011  train:nan  val:nan  lr:2.50e-05  t:120.3s
2025-07-22 17:29:27,208 | INFO     | train - E012  train:nan  val:nan  lr:1.25e-05  t:120.4s
2025-07-22 17:31:27,610 | INFO     | train - E013  train:nan  val:nan  lr:1.25e-05  t:120.4s
2025-07-22 17:33:28,040 | INFO     | train - E014  train:nan  val:nan  lr:1.25e-05  t:120.4s
2025-07-22 17:35:28,426 | INFO     | train - E015  train:nan  val:nan  lr:1.25e-05  t:120.4s
2025-07-22 17:37:28,655 | INFO     | train - E016  train:nan  val:nan  lr:6.25e-06  t:120.2s
2025-07-22 17:39:28,899 | INFO     | train - E017  train:nan  val:nan  lr:6.25e-06  t:120.2s
2025-07-22 17:41:29,086 | INFO     | train - E018  train:nan  val:nan  lr:6.25e-06  t:120.2s
2025-07-22 17:43:29,304 | INFO     | train - E019  train:nan  val:nan  lr:6.25e-06  t:120.2s
2025-07-22 17:45:29,504 | INFO     | train - E020  train:nan  val:nan  lr:3.13e-06  t:120.2s
2025-07-22 17:45:29,505 | INFO     | train - Early stopping triggered after 20 epochs with no improvement.
2025-07-22 17:45:29,505 | INFO     | train - Done. Best val_loss=inf at epoch -1.
2025-07-22 17:45:37,444 | INFO     | train - Test loss: nan
2025-07-22 17:45:37,444 | INFO     | __main__ - Pipeline completed successfully.
2025-08-06 14:17:04,003 | INFO     | utils - Loading dataset splits from: data/dataset_splits.json
2025-08-06 14:17:04,009 | INFO     | utils - Could not load splits file. Reason: Splits file not found: data/dataset_splits.json. Generating new splits.
2025-08-06 14:17:04,009 | INFO     | utils - Generating new dataset splits...
2025-08-06 14:17:05,169 | INFO     | utils - Generated splits from 1000000 profiles across 10 files: train=700000 (70.0%), val=150000 (15.0%), test=150000 (15.0%)
2025-08-06 14:17:09,299 | INFO     | utils - Saved generated splits to models/trained_model/splits_generated.json
2025-08-06 14:17:09,384 | INFO     | preprocess - Configuration has changed or processed data not found. Starting preprocessing...
2025-08-06 14:17:09,384 | INFO     | hardware - Using CUDA device: NVIDIA A100 80GB PCIe MIG 2g.20gb
2025-08-06 14:17:09,384 | INFO     | normalizer - DataNormalizer initialized on device 'cuda'.
2025-08-06 14:17:09,384 | INFO     | normalizer - Starting statistics calculation from 700000 training samples...
2025-08-07 11:47:13,951 | INFO     | utils - Loading dataset splits from: data/dataset_splits.json
2025-08-07 11:47:13,960 | INFO     | utils - Could not load splits file. Reason: Splits file not found: data/dataset_splits.json. Generating new splits.
2025-08-07 11:47:13,960 | INFO     | utils - Generating new dataset splits...
2025-08-07 11:47:14,700 | INFO     | utils - Generated splits from 1000000 profiles across 10 files: train=700000 (70.0%), val=150000 (15.0%), test=150000 (15.0%)
2025-08-07 11:47:16,660 | INFO     | utils - Saved generated splits to models/trained_model/splits_generated.json
2025-08-07 11:47:16,665 | INFO     | preprocess - Configuration has changed or processed data not found. Starting preprocessing...
2025-08-07 11:47:16,665 | INFO     | hardware - Using CUDA device: NVIDIA A100 80GB PCIe
2025-08-07 11:47:16,665 | INFO     | normalizer - DataNormalizer initialized on device 'cuda'.
2025-08-07 11:47:16,665 | INFO     | normalizer - Starting statistics calculation from 700000 training samples...
2025-08-07 11:57:59,478 | INFO     | normalizer - Finished statistics calculation in 642.81s.
2025-08-07 11:57:59,479 | INFO     | normalizer - Approximating quantiles for 'pressure_bar' using sample of 10,000,000 values (out of 52,500,000 total).
2025-08-07 11:57:59,479 | INFO     | normalizer - Approximating quantiles for 'net_reflected_flux' using sample of 10,000,000 values (out of 52,500,000 total).
2025-08-07 11:57:59,564 | INFO     | normalizer - Approximating quantiles for 'net_thermal_flux' using sample of 10,000,000 values (out of 52,500,000 total).
2025-08-07 11:57:59,568 | INFO     | normalizer - Statistics calculation complete.
2025-08-07 11:57:59,581 | INFO     | preprocess - Normalization metadata computed and saved in 642.92s.
2025-08-07 11:57:59,582 | INFO     | preprocess - Using device: cuda for normalization.
2025-08-07 11:57:59,774 | INFO     | preprocess - Processing train split (700000 profiles)...
2025-08-07 12:29:23,649 | INFO     | preprocess - Completed train split in 1884.07s.
2025-08-07 12:29:23,728 | INFO     | preprocess - Processing val split (150000 profiles)...
2025-08-07 12:33:02,522 | INFO     | preprocess - Completed val split in 218.86s.
2025-08-07 12:33:02,565 | INFO     | preprocess - Processing test split (150000 profiles)...
2025-08-07 12:36:41,406 | INFO     | preprocess - Completed test split in 218.88s.
2025-08-07 12:36:41,407 | INFO     | preprocess - Saving preprocessing summary to data/processed/preprocessing_summary.txt
2025-08-07 12:36:41,409 | INFO     | preprocess - Preprocessing completed successfully in 2964.74s.
2025-08-07 12:36:41,411 | INFO     | train - Detected A100 GPU - applying performance optimizations
2025-08-07 12:36:43,334 | INFO     | dataset - Creating dataset from data/processed/train...
2025-08-07 12:36:43,369 | INFO     | dataset - Memory estimate: 2.68 GB needed, 391.84 GB safely available
2025-08-07 12:36:43,369 | INFO     | dataset - Loading entire dataset into RAM...
2025-08-07 12:37:12,236 | INFO     | dataset - Loaded 10000/700000 samples into RAM
2025-08-07 12:37:40,976 | INFO     | dataset - Loaded 20000/700000 samples into RAM
2025-08-07 12:38:09,662 | INFO     | dataset - Loaded 30000/700000 samples into RAM
2025-08-07 12:38:38,553 | INFO     | dataset - Loaded 40000/700000 samples into RAM
2025-08-07 12:39:07,484 | INFO     | dataset - Loaded 50000/700000 samples into RAM
2025-08-07 12:39:36,389 | INFO     | dataset - Loaded 60000/700000 samples into RAM
2025-08-07 12:40:04,926 | INFO     | dataset - Loaded 70000/700000 samples into RAM
2025-08-07 12:40:33,305 | INFO     | dataset - Loaded 80000/700000 samples into RAM
2025-08-07 12:41:02,042 | INFO     | dataset - Loaded 90000/700000 samples into RAM
2025-08-07 12:41:30,966 | INFO     | dataset - Loaded 100000/700000 samples into RAM
2025-08-07 12:41:59,707 | INFO     | dataset - Loaded 110000/700000 samples into RAM
2025-08-07 12:42:28,416 | INFO     | dataset - Loaded 120000/700000 samples into RAM
2025-08-07 12:42:57,142 | INFO     | dataset - Loaded 130000/700000 samples into RAM
2025-08-07 12:43:26,054 | INFO     | dataset - Loaded 140000/700000 samples into RAM
2025-08-07 12:43:54,866 | INFO     | dataset - Loaded 150000/700000 samples into RAM
2025-08-07 12:44:23,523 | INFO     | dataset - Loaded 160000/700000 samples into RAM
2025-08-07 12:44:51,958 | INFO     | dataset - Loaded 170000/700000 samples into RAM
2025-08-07 12:45:20,437 | INFO     | dataset - Loaded 180000/700000 samples into RAM
2025-08-07 12:45:48,946 | INFO     | dataset - Loaded 190000/700000 samples into RAM
2025-08-07 12:46:17,311 | INFO     | dataset - Loaded 200000/700000 samples into RAM
2025-08-07 12:46:45,340 | INFO     | dataset - Loaded 210000/700000 samples into RAM
2025-08-07 12:47:12,959 | INFO     | dataset - Loaded 220000/700000 samples into RAM
2025-08-07 12:47:41,291 | INFO     | dataset - Loaded 230000/700000 samples into RAM
2025-08-07 12:48:09,438 | INFO     | dataset - Loaded 240000/700000 samples into RAM
2025-08-07 12:48:37,755 | INFO     | dataset - Loaded 250000/700000 samples into RAM
2025-08-07 12:49:05,893 | INFO     | dataset - Loaded 260000/700000 samples into RAM
2025-08-07 12:49:34,017 | INFO     | dataset - Loaded 270000/700000 samples into RAM
2025-08-07 12:50:02,406 | INFO     | dataset - Loaded 280000/700000 samples into RAM
2025-08-07 12:50:30,581 | INFO     | dataset - Loaded 290000/700000 samples into RAM
2025-08-07 12:50:58,936 | INFO     | dataset - Loaded 300000/700000 samples into RAM
2025-08-07 12:51:27,507 | INFO     | dataset - Loaded 310000/700000 samples into RAM
2025-08-07 12:51:55,354 | INFO     | dataset - Loaded 320000/700000 samples into RAM
2025-08-07 12:52:23,109 | INFO     | dataset - Loaded 330000/700000 samples into RAM
2025-08-07 12:52:50,860 | INFO     | dataset - Loaded 340000/700000 samples into RAM
2025-08-07 12:53:18,990 | INFO     | dataset - Loaded 350000/700000 samples into RAM
2025-08-07 12:53:47,914 | INFO     | dataset - Loaded 360000/700000 samples into RAM
2025-08-07 12:54:16,511 | INFO     | dataset - Loaded 370000/700000 samples into RAM
2025-08-07 12:54:45,097 | INFO     | dataset - Loaded 380000/700000 samples into RAM
2025-08-07 12:55:13,530 | INFO     | dataset - Loaded 390000/700000 samples into RAM
2025-08-07 12:55:41,724 | INFO     | dataset - Loaded 400000/700000 samples into RAM
2025-08-07 12:56:09,936 | INFO     | dataset - Loaded 410000/700000 samples into RAM
2025-08-07 12:56:37,540 | INFO     | dataset - Loaded 420000/700000 samples into RAM
2025-08-07 12:57:05,082 | INFO     | dataset - Loaded 430000/700000 samples into RAM
2025-08-07 12:57:32,747 | INFO     | dataset - Loaded 440000/700000 samples into RAM
2025-08-07 12:58:00,274 | INFO     | dataset - Loaded 450000/700000 samples into RAM
2025-08-07 12:58:27,942 | INFO     | dataset - Loaded 460000/700000 samples into RAM
2025-08-07 12:58:55,601 | INFO     | dataset - Loaded 470000/700000 samples into RAM
2025-08-07 12:59:23,237 | INFO     | dataset - Loaded 480000/700000 samples into RAM
2025-08-07 12:59:50,837 | INFO     | dataset - Loaded 490000/700000 samples into RAM
2025-08-07 13:00:18,598 | INFO     | dataset - Loaded 500000/700000 samples into RAM
2025-08-07 13:00:46,823 | INFO     | dataset - Loaded 510000/700000 samples into RAM
2025-08-07 13:01:15,126 | INFO     | dataset - Loaded 520000/700000 samples into RAM
2025-08-07 13:01:43,764 | INFO     | dataset - Loaded 530000/700000 samples into RAM
2025-08-07 13:02:12,257 | INFO     | dataset - Loaded 540000/700000 samples into RAM
2025-08-07 13:02:41,036 | INFO     | dataset - Loaded 550000/700000 samples into RAM
2025-08-07 13:03:09,614 | INFO     | dataset - Loaded 560000/700000 samples into RAM
2025-08-07 13:03:38,390 | INFO     | dataset - Loaded 570000/700000 samples into RAM
2025-08-07 13:04:07,223 | INFO     | dataset - Loaded 580000/700000 samples into RAM
2025-08-07 13:04:35,703 | INFO     | dataset - Loaded 590000/700000 samples into RAM
2025-08-07 13:05:03,944 | INFO     | dataset - Loaded 600000/700000 samples into RAM
2025-08-07 13:05:31,901 | INFO     | dataset - Loaded 610000/700000 samples into RAM
2025-08-07 13:06:00,355 | INFO     | dataset - Loaded 620000/700000 samples into RAM
2025-08-07 13:06:28,287 | INFO     | dataset - Loaded 630000/700000 samples into RAM
2025-08-07 13:06:56,043 | INFO     | dataset - Loaded 640000/700000 samples into RAM
2025-08-07 13:07:23,757 | INFO     | dataset - Loaded 650000/700000 samples into RAM
2025-08-07 13:07:52,473 | INFO     | dataset - Loaded 660000/700000 samples into RAM
2025-08-07 13:08:21,650 | INFO     | dataset - Loaded 670000/700000 samples into RAM
2025-08-07 13:08:51,068 | INFO     | dataset - Loaded 680000/700000 samples into RAM
2025-08-07 13:09:20,085 | INFO     | dataset - Loaded 690000/700000 samples into RAM
2025-08-07 13:09:47,886 | INFO     | dataset - Loaded 700000/700000 samples into RAM
2025-08-07 13:09:47,887 | INFO     | dataset - AtmosphericDataset initialized: 700000 samples from data/processed/train (mode: RAM)
2025-08-07 13:09:47,887 | INFO     | dataset - Creating dataset from data/processed/val...
2025-08-07 13:09:47,918 | INFO     | dataset - Memory estimate: 0.57 GB needed, 389.48 GB safely available
2025-08-07 13:09:47,918 | INFO     | dataset - Loading entire dataset into RAM...
2025-08-07 13:10:15,696 | INFO     | dataset - Loaded 10000/150000 samples into RAM
2025-08-07 13:10:43,350 | INFO     | dataset - Loaded 20000/150000 samples into RAM
2025-08-07 13:11:11,356 | INFO     | dataset - Loaded 30000/150000 samples into RAM
2025-08-07 13:11:39,926 | INFO     | dataset - Loaded 40000/150000 samples into RAM
2025-08-07 13:12:08,487 | INFO     | dataset - Loaded 50000/150000 samples into RAM
2025-08-07 13:12:36,811 | INFO     | dataset - Loaded 60000/150000 samples into RAM
2025-08-07 13:13:05,368 | INFO     | dataset - Loaded 70000/150000 samples into RAM
2025-08-07 13:13:33,943 | INFO     | dataset - Loaded 80000/150000 samples into RAM
2025-08-07 13:14:02,250 | INFO     | dataset - Loaded 90000/150000 samples into RAM
2025-08-07 13:14:30,605 | INFO     | dataset - Loaded 100000/150000 samples into RAM
2025-08-07 13:14:59,294 | INFO     | dataset - Loaded 110000/150000 samples into RAM
2025-08-07 13:15:27,029 | INFO     | dataset - Loaded 120000/150000 samples into RAM
2025-08-07 13:15:54,982 | INFO     | dataset - Loaded 130000/150000 samples into RAM
2025-08-07 13:16:23,236 | INFO     | dataset - Loaded 140000/150000 samples into RAM
2025-08-07 13:16:51,317 | INFO     | dataset - Loaded 150000/150000 samples into RAM
2025-08-07 13:16:51,320 | INFO     | dataset - AtmosphericDataset initialized: 150000 samples from data/processed/val (mode: RAM)
2025-08-07 13:16:51,320 | INFO     | dataset - Creating dataset from data/processed/test...
2025-08-07 13:16:51,355 | INFO     | dataset - Memory estimate: 0.57 GB needed, 388.98 GB safely available
2025-08-07 13:16:51,355 | INFO     | dataset - Loading entire dataset into RAM...
2025-08-07 13:17:19,716 | INFO     | dataset - Loaded 10000/150000 samples into RAM
2025-08-07 13:17:48,491 | INFO     | dataset - Loaded 20000/150000 samples into RAM
2025-08-07 13:18:16,666 | INFO     | dataset - Loaded 30000/150000 samples into RAM
2025-08-07 13:18:44,818 | INFO     | dataset - Loaded 40000/150000 samples into RAM
2025-08-07 13:19:13,713 | INFO     | dataset - Loaded 50000/150000 samples into RAM
2025-08-07 13:19:42,191 | INFO     | dataset - Loaded 60000/150000 samples into RAM
2025-08-07 13:20:11,128 | INFO     | dataset - Loaded 70000/150000 samples into RAM
2025-08-07 13:20:39,639 | INFO     | dataset - Loaded 80000/150000 samples into RAM
2025-08-07 13:21:07,923 | INFO     | dataset - Loaded 90000/150000 samples into RAM
2025-08-07 13:21:36,310 | INFO     | dataset - Loaded 100000/150000 samples into RAM
2025-08-07 13:22:04,454 | INFO     | dataset - Loaded 110000/150000 samples into RAM
2025-08-07 13:22:33,279 | INFO     | dataset - Loaded 120000/150000 samples into RAM
2025-08-07 13:23:02,211 | INFO     | dataset - Loaded 130000/150000 samples into RAM
2025-08-07 13:23:30,945 | INFO     | dataset - Loaded 140000/150000 samples into RAM
2025-08-07 13:23:58,969 | INFO     | dataset - Loaded 150000/150000 samples into RAM
2025-08-07 13:23:58,970 | INFO     | dataset - AtmosphericDataset initialized: 150000 samples from data/processed/test (mode: RAM)
2025-08-07 13:23:58,970 | INFO     | train - Datasets ready – train:700,000  val:150,000  test:150,000
2025-08-07 13:23:58,970 | INFO     | train - Using DevicePrefetchLoader for CUDA transfers
2025-08-07 13:23:59,056 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:23:59,061 | INFO     | model - Attempting torch.compile with mode='default'
2025-08-07 13:24:01,359 | INFO     | model - Model compiled successfully
2025-08-07 13:24:01,359 | INFO     | model - Model moved to device: cuda
2025-08-07 13:24:01,359 | INFO     | train - Optimizer: adamw  lr=1.00e-04  wd=1.00e-05
2025-08-07 13:24:01,360 | INFO     | train - Cosine scheduler with 5 warmup epochs.
2025-08-07 13:24:01,360 | INFO     | train - AMP enabled.
2025-08-07 13:24:01,360 | INFO     | train - Effective batch size: 256 (accumulation: 1)
2025-08-07 13:24:01,478 | INFO     | train - Training for 300 epochs.
2025-08-07 13:26:54,510 | INFO     | train - E001  train:3.018e+01  val:2.903e+01  lr:2.00e-05  t:173.0s  ↓inf
2025-08-07 13:26:54,583 | INFO     | train - Saved best model (epoch 1).
2025-08-07 13:26:54,612 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:26:54,704 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:26:54,710 | INFO     | model - Model moved to device: cuda
2025-08-07 13:26:54,711 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:28:59,959 | INFO     | train - E002  train:3.392e-01  val:5.483e-02  lr:4.00e-05  t:125.2s  ↓2.897e+01
2025-08-07 13:29:00,018 | INFO     | train - Saved best model (epoch 2).
2025-08-07 13:29:00,035 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:29:00,115 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:29:00,120 | INFO     | model - Model moved to device: cuda
2025-08-07 13:29:00,121 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:31:05,987 | INFO     | train - E003  train:1.101e-01  val:5.814e-02  lr:6.00e-05  t:125.9s
2025-08-07 13:33:12,173 | INFO     | train - E004  train:6.694e-02  val:3.895e-02  lr:8.00e-05  t:126.1s  ↓1.588e-02
2025-08-07 13:33:12,235 | INFO     | train - Saved best model (epoch 4).
2025-08-07 13:33:12,268 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:33:12,347 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:33:12,352 | INFO     | model - Model moved to device: cuda
2025-08-07 13:33:12,354 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:35:18,708 | INFO     | train - E005  train:3.964e-02  val:1.843e-02  lr:1.00e-04  t:126.4s  ↓2.053e-02
2025-08-07 13:35:18,757 | INFO     | train - Saved best model (epoch 5).
2025-08-07 13:35:18,788 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:35:18,867 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:35:18,872 | INFO     | model - Model moved to device: cuda
2025-08-07 13:35:18,874 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:37:25,105 | INFO     | train - E006  train:2.194e-02  val:1.321e-02  lr:1.00e-04  t:126.2s  ↓5.219e-03
2025-08-07 13:37:25,163 | INFO     | train - Saved best model (epoch 6).
2025-08-07 13:37:25,191 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:37:25,271 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:37:25,276 | INFO     | model - Model moved to device: cuda
2025-08-07 13:37:25,277 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:39:31,387 | INFO     | train - E007  train:1.017e-02  val:6.148e-03  lr:1.00e-04  t:126.1s  ↓7.061e-03
2025-08-07 13:39:31,443 | INFO     | train - Saved best model (epoch 7).
2025-08-07 13:39:31,472 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:39:31,577 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:39:31,582 | INFO     | model - Model moved to device: cuda
2025-08-07 13:39:31,584 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:41:37,719 | INFO     | train - E008  train:4.993e-03  val:3.743e-03  lr:1.00e-04  t:126.1s  ↓2.404e-03
2025-08-07 13:41:37,782 | INFO     | train - Saved best model (epoch 8).
2025-08-07 13:41:37,806 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:41:37,886 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:41:37,891 | INFO     | model - Model moved to device: cuda
2025-08-07 13:41:37,892 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:43:43,776 | INFO     | train - E009  train:2.595e-03  val:9.842e-04  lr:1.00e-04  t:125.9s  ↓2.759e-03
2025-08-07 13:43:43,858 | INFO     | train - Saved best model (epoch 9).
2025-08-07 13:43:43,881 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:43:43,986 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:43:43,991 | INFO     | model - Model moved to device: cuda
2025-08-07 13:43:43,993 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:45:49,876 | INFO     | train - E010  train:2.438e-03  val:8.240e-04  lr:9.99e-05  t:125.9s  ↓1.602e-04
2025-08-07 13:45:49,921 | INFO     | train - Saved best model (epoch 10).
2025-08-07 13:45:49,946 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:45:50,025 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:45:50,029 | INFO     | model - Model moved to device: cuda
2025-08-07 13:45:50,031 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:47:55,882 | INFO     | train - E011  train:1.932e-03  val:6.792e-04  lr:9.99e-05  t:125.9s  ↓1.448e-04
2025-08-07 13:47:55,945 | INFO     | train - Saved best model (epoch 11).
2025-08-07 13:47:55,974 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:47:56,054 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:47:56,058 | INFO     | model - Model moved to device: cuda
2025-08-07 13:47:56,060 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:50:01,909 | INFO     | train - E012  train:2.268e-03  val:1.764e-03  lr:9.99e-05  t:125.8s
2025-08-07 13:52:07,843 | INFO     | train - E013  train:2.484e-03  val:7.479e-03  lr:9.98e-05  t:125.9s
2025-08-07 13:54:13,410 | INFO     | train - E014  train:1.446e-03  val:2.722e-04  lr:9.98e-05  t:125.5s  ↓4.071e-04
2025-08-07 13:54:13,478 | INFO     | train - Saved best model (epoch 14).
2025-08-07 13:54:13,497 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 13:54:13,577 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 13:54:13,582 | INFO     | model - Model moved to device: cuda
2025-08-07 13:54:13,584 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 13:56:19,179 | INFO     | train - E015  train:7.947e-04  val:4.853e-04  lr:9.97e-05  t:125.6s
2025-08-07 13:58:24,664 | INFO     | train - E016  train:2.275e-03  val:5.537e-04  lr:9.97e-05  t:125.5s
2025-08-07 14:00:30,186 | INFO     | train - E017  train:3.076e-03  val:1.822e-04  lr:9.96e-05  t:125.5s  ↓8.997e-05
2025-08-07 14:00:30,250 | INFO     | train - Saved best model (epoch 17).
2025-08-07 14:00:30,270 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-07 14:00:30,350 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-07 14:00:30,355 | INFO     | model - Model moved to device: cuda
2025-08-07 14:00:30,356 | INFO     | model - Model export disabled in config – skipping.
2025-08-07 14:02:35,813 | INFO     | train - E018  train:8.757e-04  val:2.162e-04  lr:9.95e-05  t:125.5s
2025-08-07 14:04:41,284 | INFO     | train - E019  train:1.773e-03  val:3.543e-04  lr:9.94e-05  t:125.5s
2025-08-07 14:06:46,815 | INFO     | train - E020  train:1.181e-03  val:3.223e-04  lr:9.94e-05  t:125.5s
2025-08-07 14:08:50,050 | ERROR    | __main__ - Pipeline error: DataLoader worker (pid(s) 3330405) exited unexpectedly
2025-08-07 23:00:36,568 | INFO     | utils - Loading dataset splits from: data/dataset_splits.json
2025-08-07 23:00:36,591 | INFO     | utils - Could not load splits file. Reason: Splits file not found: data/dataset_splits.json. Generating new splits.
2025-08-07 23:00:36,591 | INFO     | utils - Generating new dataset splits...
2025-08-07 23:00:37,353 | INFO     | utils - Generated splits from 1000000 profiles across 10 files: train=700000 (70.0%), val=150000 (15.0%), test=150000 (15.0%)
2025-08-07 23:00:39,360 | INFO     | utils - Saved generated splits to models/trained_model/splits_generated.json
2025-08-07 23:00:39,363 | INFO     | preprocess - Configuration has changed or processed data not found. Starting preprocessing...
2025-08-07 23:00:39,363 | INFO     | hardware - Using CUDA device: NVIDIA A100 80GB PCIe
2025-08-07 23:00:39,363 | INFO     | normalizer - DataNormalizer initialized on device 'cuda'.
2025-08-07 23:00:39,363 | INFO     | normalizer - Starting statistics calculation from 700000 training samples...
2025-08-07 23:10:34,854 | INFO     | normalizer - Finished statistics calculation in 595.49s.
2025-08-07 23:10:34,854 | INFO     | normalizer - Approximating quantiles for 'net_thermal_flux' using sample of 10,000,000 values (out of 52,500,000 total).
2025-08-07 23:10:34,907 | INFO     | normalizer - Approximating quantiles for 'net_reflected_flux' using sample of 10,000,000 values (out of 52,500,000 total).
2025-08-07 23:10:34,910 | INFO     | normalizer - Approximating quantiles for 'pressure_bar' using sample of 10,000,000 values (out of 52,500,000 total).
2025-08-07 23:10:34,910 | INFO     | normalizer - Statistics calculation complete.
2025-08-07 23:10:34,916 | INFO     | preprocess - Normalization metadata computed and saved in 595.55s.
2025-08-07 23:10:34,916 | INFO     | preprocess - Using device: cuda for normalization.
2025-08-07 23:10:35,085 | INFO     | preprocess - Processing train split (700000 profiles)...
2025-08-07 23:41:44,954 | INFO     | preprocess - Completed train split in 1870.04s.
2025-08-07 23:41:45,016 | INFO     | preprocess - Processing val split (150000 profiles)...
2025-08-07 23:45:36,540 | INFO     | preprocess - Completed val split in 231.57s.
2025-08-07 23:45:36,606 | INFO     | preprocess - Processing test split (150000 profiles)...
2025-08-07 23:49:27,186 | INFO     | preprocess - Completed test split in 230.62s.
2025-08-07 23:49:27,207 | INFO     | preprocess - Saving preprocessing summary to data/processed/preprocessing_summary.txt
2025-08-07 23:49:27,207 | INFO     | preprocess - Preprocessing completed successfully in 2927.84s.
2025-08-07 23:49:27,208 | INFO     | train - Detected A100 GPU - applying performance optimizations
2025-08-07 23:49:29,090 | INFO     | dataset - Creating dataset from data/processed/train...
2025-08-07 23:49:29,133 | INFO     | dataset - Memory estimate: 2.68 GB needed, 392.02 GB safely available
2025-08-07 23:49:29,133 | INFO     | dataset - Loading entire dataset into RAM...
2025-08-07 23:50:00,058 | INFO     | dataset - Loaded 10000/700000 samples into RAM
2025-08-07 23:50:30,828 | INFO     | dataset - Loaded 20000/700000 samples into RAM
2025-08-07 23:51:01,782 | INFO     | dataset - Loaded 30000/700000 samples into RAM
2025-08-07 23:51:32,655 | INFO     | dataset - Loaded 40000/700000 samples into RAM
2025-08-07 23:52:03,630 | INFO     | dataset - Loaded 50000/700000 samples into RAM
2025-08-07 23:52:34,385 | INFO     | dataset - Loaded 60000/700000 samples into RAM
2025-08-07 23:53:05,157 | INFO     | dataset - Loaded 70000/700000 samples into RAM
2025-08-07 23:53:35,877 | INFO     | dataset - Loaded 80000/700000 samples into RAM
2025-08-07 23:54:06,682 | INFO     | dataset - Loaded 90000/700000 samples into RAM
2025-08-07 23:54:37,332 | INFO     | dataset - Loaded 100000/700000 samples into RAM
2025-08-07 23:55:07,701 | INFO     | dataset - Loaded 110000/700000 samples into RAM
2025-08-07 23:55:38,215 | INFO     | dataset - Loaded 120000/700000 samples into RAM
2025-08-07 23:56:08,955 | INFO     | dataset - Loaded 130000/700000 samples into RAM
2025-08-07 23:56:39,874 | INFO     | dataset - Loaded 140000/700000 samples into RAM
2025-08-07 23:57:10,709 | INFO     | dataset - Loaded 150000/700000 samples into RAM
2025-08-07 23:57:41,563 | INFO     | dataset - Loaded 160000/700000 samples into RAM
2025-08-07 23:58:12,381 | INFO     | dataset - Loaded 170000/700000 samples into RAM
2025-08-07 23:58:43,378 | INFO     | dataset - Loaded 180000/700000 samples into RAM
2025-08-07 23:59:14,396 | INFO     | dataset - Loaded 190000/700000 samples into RAM
2025-08-07 23:59:45,093 | INFO     | dataset - Loaded 200000/700000 samples into RAM
2025-08-08 00:00:15,948 | INFO     | dataset - Loaded 210000/700000 samples into RAM
2025-08-08 00:00:46,663 | INFO     | dataset - Loaded 220000/700000 samples into RAM
2025-08-08 00:01:17,605 | INFO     | dataset - Loaded 230000/700000 samples into RAM
2025-08-08 00:01:48,179 | INFO     | dataset - Loaded 240000/700000 samples into RAM
2025-08-08 00:02:18,935 | INFO     | dataset - Loaded 250000/700000 samples into RAM
2025-08-08 00:02:49,552 | INFO     | dataset - Loaded 260000/700000 samples into RAM
2025-08-08 00:03:20,325 | INFO     | dataset - Loaded 270000/700000 samples into RAM
2025-08-08 00:03:51,085 | INFO     | dataset - Loaded 280000/700000 samples into RAM
2025-08-08 00:04:21,928 | INFO     | dataset - Loaded 290000/700000 samples into RAM
2025-08-08 00:04:52,795 | INFO     | dataset - Loaded 300000/700000 samples into RAM
2025-08-08 00:05:23,673 | INFO     | dataset - Loaded 310000/700000 samples into RAM
2025-08-08 00:05:54,489 | INFO     | dataset - Loaded 320000/700000 samples into RAM
2025-08-08 00:06:25,399 | INFO     | dataset - Loaded 330000/700000 samples into RAM
2025-08-08 00:06:56,421 | INFO     | dataset - Loaded 340000/700000 samples into RAM
2025-08-08 00:07:27,146 | INFO     | dataset - Loaded 350000/700000 samples into RAM
2025-08-08 00:07:57,874 | INFO     | dataset - Loaded 360000/700000 samples into RAM
2025-08-08 00:08:28,579 | INFO     | dataset - Loaded 370000/700000 samples into RAM
2025-08-08 00:08:59,275 | INFO     | dataset - Loaded 380000/700000 samples into RAM
2025-08-08 00:09:29,992 | INFO     | dataset - Loaded 390000/700000 samples into RAM
2025-08-08 00:10:00,735 | INFO     | dataset - Loaded 400000/700000 samples into RAM
2025-08-08 00:10:31,265 | INFO     | dataset - Loaded 410000/700000 samples into RAM
2025-08-08 00:11:02,072 | INFO     | dataset - Loaded 420000/700000 samples into RAM
2025-08-08 00:11:32,907 | INFO     | dataset - Loaded 430000/700000 samples into RAM
2025-08-08 00:12:03,986 | INFO     | dataset - Loaded 440000/700000 samples into RAM
2025-08-08 00:12:34,697 | INFO     | dataset - Loaded 450000/700000 samples into RAM
2025-08-08 00:13:05,501 | INFO     | dataset - Loaded 460000/700000 samples into RAM
2025-08-08 00:13:36,074 | INFO     | dataset - Loaded 470000/700000 samples into RAM
2025-08-08 00:14:06,958 | INFO     | dataset - Loaded 480000/700000 samples into RAM
2025-08-08 00:14:37,653 | INFO     | dataset - Loaded 490000/700000 samples into RAM
2025-08-08 00:15:08,461 | INFO     | dataset - Loaded 500000/700000 samples into RAM
2025-08-08 00:15:39,019 | INFO     | dataset - Loaded 510000/700000 samples into RAM
2025-08-08 00:16:09,502 | INFO     | dataset - Loaded 520000/700000 samples into RAM
2025-08-08 00:16:40,249 | INFO     | dataset - Loaded 530000/700000 samples into RAM
2025-08-08 00:17:10,782 | INFO     | dataset - Loaded 540000/700000 samples into RAM
2025-08-08 00:17:41,563 | INFO     | dataset - Loaded 550000/700000 samples into RAM
2025-08-08 00:18:12,288 | INFO     | dataset - Loaded 560000/700000 samples into RAM
2025-08-08 00:18:43,043 | INFO     | dataset - Loaded 570000/700000 samples into RAM
2025-08-08 00:19:13,953 | INFO     | dataset - Loaded 580000/700000 samples into RAM
2025-08-08 00:19:44,776 | INFO     | dataset - Loaded 590000/700000 samples into RAM
2025-08-08 00:20:15,786 | INFO     | dataset - Loaded 600000/700000 samples into RAM
2025-08-08 00:20:46,671 | INFO     | dataset - Loaded 610000/700000 samples into RAM
2025-08-08 00:21:17,254 | INFO     | dataset - Loaded 620000/700000 samples into RAM
2025-08-08 00:21:47,786 | INFO     | dataset - Loaded 630000/700000 samples into RAM
2025-08-08 00:22:18,680 | INFO     | dataset - Loaded 640000/700000 samples into RAM
2025-08-08 00:22:49,663 | INFO     | dataset - Loaded 650000/700000 samples into RAM
2025-08-08 00:23:20,481 | INFO     | dataset - Loaded 660000/700000 samples into RAM
2025-08-08 00:23:51,158 | INFO     | dataset - Loaded 670000/700000 samples into RAM
2025-08-08 00:24:21,994 | INFO     | dataset - Loaded 680000/700000 samples into RAM
2025-08-08 00:24:52,607 | INFO     | dataset - Loaded 690000/700000 samples into RAM
2025-08-08 00:25:23,390 | INFO     | dataset - Loaded 700000/700000 samples into RAM
2025-08-08 00:25:23,391 | INFO     | dataset - AtmosphericDataset initialized: 700000 samples from data/processed/train (mode: RAM)
2025-08-08 00:25:23,391 | INFO     | dataset - Creating dataset from data/processed/val...
2025-08-08 00:25:23,419 | INFO     | dataset - Memory estimate: 0.57 GB needed, 389.86 GB safely available
2025-08-08 00:25:23,419 | INFO     | dataset - Loading entire dataset into RAM...
2025-08-08 00:25:54,498 | INFO     | dataset - Loaded 10000/150000 samples into RAM
2025-08-08 00:26:25,317 | INFO     | dataset - Loaded 20000/150000 samples into RAM
2025-08-08 00:26:56,217 | INFO     | dataset - Loaded 30000/150000 samples into RAM
2025-08-08 00:27:26,875 | INFO     | dataset - Loaded 40000/150000 samples into RAM
2025-08-08 00:27:57,578 | INFO     | dataset - Loaded 50000/150000 samples into RAM
2025-08-08 00:28:28,367 | INFO     | dataset - Loaded 60000/150000 samples into RAM
2025-08-08 00:28:58,904 | INFO     | dataset - Loaded 70000/150000 samples into RAM
2025-08-08 00:29:29,739 | INFO     | dataset - Loaded 80000/150000 samples into RAM
2025-08-08 00:30:00,452 | INFO     | dataset - Loaded 90000/150000 samples into RAM
2025-08-08 00:30:31,591 | INFO     | dataset - Loaded 100000/150000 samples into RAM
2025-08-08 00:31:02,380 | INFO     | dataset - Loaded 110000/150000 samples into RAM
2025-08-08 00:31:33,117 | INFO     | dataset - Loaded 120000/150000 samples into RAM
2025-08-08 00:32:03,846 | INFO     | dataset - Loaded 130000/150000 samples into RAM
2025-08-08 00:32:34,679 | INFO     | dataset - Loaded 140000/150000 samples into RAM
2025-08-08 00:33:05,535 | INFO     | dataset - Loaded 150000/150000 samples into RAM
2025-08-08 00:33:05,536 | INFO     | dataset - AtmosphericDataset initialized: 150000 samples from data/processed/val (mode: RAM)
2025-08-08 00:33:05,536 | INFO     | dataset - Creating dataset from data/processed/test...
2025-08-08 00:33:05,581 | INFO     | dataset - Memory estimate: 0.57 GB needed, 389.42 GB safely available
2025-08-08 00:33:05,581 | INFO     | dataset - Loading entire dataset into RAM...
2025-08-08 00:33:36,480 | INFO     | dataset - Loaded 10000/150000 samples into RAM
2025-08-08 00:34:07,157 | INFO     | dataset - Loaded 20000/150000 samples into RAM
2025-08-08 00:34:37,895 | INFO     | dataset - Loaded 30000/150000 samples into RAM
2025-08-08 00:35:08,651 | INFO     | dataset - Loaded 40000/150000 samples into RAM
2025-08-08 00:35:39,437 | INFO     | dataset - Loaded 50000/150000 samples into RAM
2025-08-08 00:36:10,031 | INFO     | dataset - Loaded 60000/150000 samples into RAM
2025-08-08 00:36:40,646 | INFO     | dataset - Loaded 70000/150000 samples into RAM
2025-08-08 00:37:11,347 | INFO     | dataset - Loaded 80000/150000 samples into RAM
2025-08-08 00:37:42,061 | INFO     | dataset - Loaded 90000/150000 samples into RAM
2025-08-08 00:38:13,157 | INFO     | dataset - Loaded 100000/150000 samples into RAM
2025-08-08 00:38:43,873 | INFO     | dataset - Loaded 110000/150000 samples into RAM
2025-08-08 00:39:14,744 | INFO     | dataset - Loaded 120000/150000 samples into RAM
2025-08-08 00:39:45,641 | INFO     | dataset - Loaded 130000/150000 samples into RAM
2025-08-08 00:40:16,588 | INFO     | dataset - Loaded 140000/150000 samples into RAM
2025-08-08 00:40:47,744 | INFO     | dataset - Loaded 150000/150000 samples into RAM
2025-08-08 00:40:47,745 | INFO     | dataset - AtmosphericDataset initialized: 150000 samples from data/processed/test (mode: RAM)
2025-08-08 00:40:47,745 | INFO     | train - Datasets ready – train:700,000  val:150,000  test:150,000
2025-08-08 00:40:47,745 | INFO     | train - Increasing num_workers from 1 to 8 for better GPU utilization
2025-08-08 00:40:47,746 | INFO     | train - Using DevicePrefetchLoader for CUDA transfers
2025-08-08 00:40:47,836 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 00:40:47,842 | INFO     | model - Attempting torch.compile with mode='default'
2025-08-08 00:40:51,200 | INFO     | model - Model compiled successfully
2025-08-08 00:40:51,200 | INFO     | model - Model moved to device: cuda
2025-08-08 00:40:51,201 | INFO     | train - Optimizer: adamw  lr=1.00e-04  wd=1.00e-05
2025-08-08 00:40:51,201 | INFO     | train - Cosine scheduler with 5 warmup epochs.
2025-08-08 00:40:51,201 | INFO     | train - AMP enabled.
2025-08-08 00:40:51,201 | INFO     | train - Effective batch size: 256 (accumulation: 1)
2025-08-08 00:40:51,320 | INFO     | train - Training for 300 epochs.
2025-08-08 00:43:05,157 | INFO     | train - E001  train:3.018e+01  val:2.903e+01  lr:2.00e-05  t:133.8s  ↓inf
2025-08-08 00:43:05,235 | INFO     | train - Saved best model (epoch 1).
2025-08-08 00:43:05,249 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 00:43:05,343 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 00:43:05,348 | INFO     | model - Model moved to device: cuda
2025-08-08 00:43:05,807 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 00:43:05,807 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 00:43:06,943 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 00:45:15,199 | INFO     | train - E002  train:3.392e-01  val:1.046e-01  lr:4.00e-05  t:128.0s  ↓2.892e+01
2025-08-08 00:45:15,270 | INFO     | train - Saved best model (epoch 2).
2025-08-08 00:45:15,287 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 00:45:15,366 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 00:45:15,371 | INFO     | model - Model moved to device: cuda
2025-08-08 00:45:15,465 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 00:45:15,465 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 00:45:16,158 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 00:47:24,224 | INFO     | train - E003  train:1.165e-01  val:2.230e-01  lr:6.00e-05  t:127.9s
2025-08-08 00:49:29,945 | INFO     | train - E004  train:6.688e-02  val:3.354e-02  lr:8.00e-05  t:125.7s  ↓7.108e-02
2025-08-08 00:49:30,019 | INFO     | train - Saved best model (epoch 4).
2025-08-08 00:49:30,034 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 00:49:30,112 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 00:49:30,116 | INFO     | model - Model moved to device: cuda
2025-08-08 00:49:30,219 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 00:49:30,219 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 00:49:31,219 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 00:51:39,529 | INFO     | train - E005  train:3.810e-02  val:3.228e-02  lr:1.00e-04  t:128.1s  ↓1.258e-03
2025-08-08 00:51:39,581 | INFO     | train - Saved best model (epoch 5).
2025-08-08 00:51:39,601 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 00:51:39,674 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 00:51:39,679 | INFO     | model - Model moved to device: cuda
2025-08-08 00:51:39,773 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 00:51:39,773 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 00:51:40,458 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 00:53:48,606 | INFO     | train - E006  train:2.303e-02  val:8.236e-03  lr:1.00e-04  t:127.9s  ↓2.405e-02
2025-08-08 00:53:48,682 | INFO     | train - Saved best model (epoch 6).
2025-08-08 00:53:48,700 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 00:53:48,775 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 00:53:48,780 | INFO     | model - Model moved to device: cuda
2025-08-08 00:53:49,185 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 00:53:49,186 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 00:53:49,873 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 00:55:57,960 | INFO     | train - E007  train:9.641e-03  val:4.834e-03  lr:1.00e-04  t:127.9s  ↓3.402e-03
2025-08-08 00:55:58,033 | INFO     | train - Saved best model (epoch 7).
2025-08-08 00:55:58,084 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 00:55:58,157 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 00:55:58,162 | INFO     | model - Model moved to device: cuda
2025-08-08 00:55:58,255 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 00:55:58,255 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 00:55:59,269 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 00:58:07,395 | INFO     | train - E008  train:4.815e-03  val:3.581e-03  lr:1.00e-04  t:127.9s  ↓1.252e-03
2025-08-08 00:58:07,469 | INFO     | train - Saved best model (epoch 8).
2025-08-08 00:58:07,491 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 00:58:07,565 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 00:58:07,569 | INFO     | model - Model moved to device: cuda
2025-08-08 00:58:07,690 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 00:58:07,690 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 00:58:08,716 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:00:16,849 | INFO     | train - E009  train:3.109e-03  val:2.358e-03  lr:1.00e-04  t:127.9s  ↓1.223e-03
2025-08-08 01:00:16,915 | INFO     | train - Saved best model (epoch 9).
2025-08-08 01:00:16,933 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:00:17,009 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:00:17,014 | INFO     | model - Model moved to device: cuda
2025-08-08 01:00:17,106 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:00:17,107 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:00:18,147 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:02:26,320 | INFO     | train - E010  train:2.048e-03  val:8.020e-04  lr:9.99e-05  t:128.0s  ↓1.556e-03
2025-08-08 01:02:26,397 | INFO     | train - Saved best model (epoch 10).
2025-08-08 01:02:26,416 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:02:26,492 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:02:26,497 | INFO     | model - Model moved to device: cuda
2025-08-08 01:02:26,595 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:02:26,596 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:02:27,623 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:04:35,750 | INFO     | train - E011  train:3.084e-03  val:5.296e-04  lr:9.99e-05  t:127.9s  ↓2.724e-04
2025-08-08 01:04:35,823 | INFO     | train - Saved best model (epoch 11).
2025-08-08 01:04:35,837 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:04:35,918 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:04:35,922 | INFO     | model - Model moved to device: cuda
2025-08-08 01:04:36,017 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:04:36,050 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:04:36,749 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:06:45,183 | INFO     | train - E012  train:1.377e-03  val:7.060e-04  lr:9.99e-05  t:128.2s
2025-08-08 01:08:50,433 | INFO     | train - E013  train:2.841e-03  val:9.517e-04  lr:9.98e-05  t:125.2s
2025-08-08 01:10:55,704 | INFO     | train - E014  train:2.129e-03  val:3.164e-04  lr:9.98e-05  t:125.2s  ↓2.132e-04
2025-08-08 01:10:55,781 | INFO     | train - Saved best model (epoch 14).
2025-08-08 01:10:55,799 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:10:55,875 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:10:55,880 | INFO     | model - Model moved to device: cuda
2025-08-08 01:10:55,987 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:10:55,988 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:10:56,695 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:13:05,160 | INFO     | train - E015  train:2.271e-03  val:3.137e-04  lr:9.97e-05  t:128.3s  ↓2.701e-06
2025-08-08 01:13:05,233 | INFO     | train - Saved best model (epoch 15).
2025-08-08 01:13:05,265 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:13:05,343 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:13:05,347 | INFO     | model - Model moved to device: cuda
2025-08-08 01:13:05,439 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:13:05,440 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:13:06,138 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:15:14,608 | INFO     | train - E016  train:3.420e-04  val:3.611e-04  lr:9.97e-05  t:128.3s
2025-08-08 01:17:19,428 | INFO     | train - E017  train:3.339e-03  val:2.381e-04  lr:9.96e-05  t:124.8s  ↓7.559e-05
2025-08-08 01:17:19,502 | INFO     | train - Saved best model (epoch 17).
2025-08-08 01:17:19,519 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:17:19,594 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:17:19,599 | INFO     | model - Model moved to device: cuda
2025-08-08 01:17:19,705 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:17:19,705 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:17:20,412 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:19:28,671 | INFO     | train - E018  train:1.333e-03  val:2.689e-04  lr:9.95e-05  t:128.0s
2025-08-08 01:21:33,593 | INFO     | train - E019  train:2.328e-03  val:2.013e-04  lr:9.94e-05  t:124.9s  ↓3.681e-05
2025-08-08 01:21:33,668 | INFO     | train - Saved best model (epoch 19).
2025-08-08 01:21:33,680 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:21:33,758 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:21:33,762 | INFO     | model - Model moved to device: cuda
2025-08-08 01:21:33,864 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:21:33,864 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:21:34,927 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:23:42,991 | INFO     | train - E020  train:1.222e-03  val:2.290e-04  lr:9.94e-05  t:127.9s
2025-08-08 01:25:48,088 | INFO     | train - E021  train:1.136e-03  val:1.510e-04  lr:9.93e-05  t:125.1s  ↓5.032e-05
2025-08-08 01:25:48,157 | INFO     | train - Saved best model (epoch 21).
2025-08-08 01:25:48,171 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:25:48,247 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:25:48,253 | INFO     | model - Model moved to device: cuda
2025-08-08 01:25:48,354 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:25:48,355 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:25:49,055 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:27:57,260 | INFO     | train - E022  train:2.069e-04  val:2.727e-04  lr:9.92e-05  t:128.0s
2025-08-08 01:30:02,692 | INFO     | train - E023  train:4.700e-04  val:7.735e-04  lr:9.91e-05  t:125.4s
2025-08-08 01:32:08,090 | INFO     | train - E024  train:2.481e-03  val:1.648e-04  lr:9.90e-05  t:125.4s
2025-08-08 01:34:13,244 | INFO     | train - E025  train:2.184e-04  val:8.683e-02  lr:9.89e-05  t:125.1s
2025-08-08 01:36:18,537 | INFO     | train - E026  train:9.218e-04  val:2.130e-04  lr:9.88e-05  t:125.3s
2025-08-08 01:38:23,667 | INFO     | train - E027  train:1.657e-03  val:1.371e-04  lr:9.86e-05  t:125.1s  ↓1.388e-05
2025-08-08 01:38:23,737 | INFO     | train - Saved best model (epoch 27).
2025-08-08 01:38:23,751 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:38:23,827 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:38:23,832 | INFO     | model - Model moved to device: cuda
2025-08-08 01:38:23,937 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:38:23,938 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:38:25,037 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:40:33,227 | INFO     | train - E028  train:1.763e-04  val:2.163e-04  lr:9.85e-05  t:128.0s
2025-08-08 01:42:38,242 | INFO     | train - E029  train:5.648e-04  val:1.702e-04  lr:9.84e-05  t:125.0s
2025-08-08 01:44:43,548 | INFO     | train - E030  train:4.332e-04  val:1.223e-04  lr:9.82e-05  t:125.3s  ↓1.479e-05
2025-08-08 01:44:43,621 | INFO     | train - Saved best model (epoch 30).
2025-08-08 01:44:43,641 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:44:43,718 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:44:43,722 | INFO     | model - Model moved to device: cuda
2025-08-08 01:44:43,884 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:44:43,884 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:44:44,583 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:46:53,216 | INFO     | train - E031  train:3.336e-04  val:1.069e-04  lr:9.81e-05  t:128.4s  ↓1.541e-05
2025-08-08 01:46:53,287 | INFO     | train - Saved best model (epoch 31).
2025-08-08 01:46:53,307 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:46:53,385 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:46:53,390 | INFO     | model - Model moved to device: cuda
2025-08-08 01:46:53,486 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:46:53,486 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:46:54,185 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:49:02,483 | INFO     | train - E032  train:6.177e-04  val:1.043e-04  lr:9.79e-05  t:128.1s  ↓2.583e-06
2025-08-08 01:49:02,551 | INFO     | train - Saved best model (epoch 32).
2025-08-08 01:49:02,566 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:49:02,642 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:49:02,647 | INFO     | model - Model moved to device: cuda
2025-08-08 01:49:02,740 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:49:02,740 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:49:03,437 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:51:12,103 | INFO     | train - E033  train:1.151e-04  val:2.414e-04  lr:9.78e-05  t:128.5s
2025-08-08 01:53:17,063 | INFO     | train - E034  train:6.822e-04  val:1.358e-04  lr:9.76e-05  t:124.9s
2025-08-08 01:55:22,269 | INFO     | train - E035  train:3.229e-04  val:8.249e-05  lr:9.75e-05  t:125.2s  ↓2.182e-05
2025-08-08 01:55:22,338 | INFO     | train - Saved best model (epoch 35).
2025-08-08 01:55:22,359 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 01:55:22,436 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 01:55:22,441 | INFO     | model - Model moved to device: cuda
2025-08-08 01:55:22,544 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 01:55:22,544 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 01:55:23,249 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 01:57:31,603 | INFO     | train - E036  train:6.918e-04  val:6.640e-04  lr:9.73e-05  t:128.1s
2025-08-08 01:59:36,715 | INFO     | train - E037  train:1.276e-04  val:8.835e-05  lr:9.71e-05  t:125.1s
2025-08-08 02:01:42,113 | INFO     | train - E038  train:4.569e-04  val:6.675e-05  lr:9.69e-05  t:125.4s  ↓1.574e-05
2025-08-08 02:01:42,185 | INFO     | train - Saved best model (epoch 38).
2025-08-08 02:01:42,206 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 02:01:42,282 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 02:01:42,287 | INFO     | model - Model moved to device: cuda
2025-08-08 02:01:42,390 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 02:01:42,390 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 02:01:43,097 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 02:03:51,393 | INFO     | train - E039  train:1.007e-04  val:2.310e-04  lr:9.68e-05  t:128.1s
2025-08-08 02:05:56,380 | INFO     | train - E040  train:5.687e-04  val:8.269e-05  lr:9.66e-05  t:124.9s
2025-08-08 02:08:01,637 | INFO     | train - E041  train:1.768e-04  val:6.031e-05  lr:9.64e-05  t:125.2s  ↓6.443e-06
2025-08-08 02:08:01,709 | INFO     | train - Saved best model (epoch 41).
2025-08-08 02:08:01,730 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 02:08:01,806 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 02:08:01,810 | INFO     | model - Model moved to device: cuda
2025-08-08 02:08:01,938 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 02:08:01,938 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 02:08:03,077 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 02:10:11,507 | INFO     | train - E042  train:9.605e-05  val:1.007e-04  lr:9.62e-05  t:128.2s
2025-08-08 02:12:16,386 | INFO     | train - E043  train:1.007e-03  val:9.214e-05  lr:9.60e-05  t:124.8s
2025-08-08 02:14:21,461 | INFO     | train - E044  train:2.509e-04  val:7.515e-05  lr:9.57e-05  t:125.0s
2025-08-08 02:16:26,565 | INFO     | train - E045  train:3.713e-04  val:1.082e-04  lr:9.55e-05  t:125.1s
2025-08-08 02:18:31,749 | INFO     | train - E046  train:9.739e-05  val:1.392e-04  lr:9.53e-05  t:125.2s
2025-08-08 02:20:37,159 | INFO     | train - E047  train:4.798e-04  val:3.854e-05  lr:9.51e-05  t:125.4s  ↓2.178e-05
2025-08-08 02:20:37,231 | INFO     | train - Saved best model (epoch 47).
2025-08-08 02:20:37,250 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 02:20:37,327 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 02:20:37,331 | INFO     | model - Model moved to device: cuda
2025-08-08 02:20:37,440 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 02:20:37,440 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 02:20:38,145 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 02:22:46,478 | INFO     | train - E048  train:7.563e-05  val:1.256e-04  lr:9.48e-05  t:128.1s
2025-08-08 02:24:51,452 | INFO     | train - E049  train:3.622e-04  val:7.051e-05  lr:9.46e-05  t:124.9s
2025-08-08 02:26:56,722 | INFO     | train - E050  train:8.374e-05  val:9.097e-05  lr:9.44e-05  t:125.2s
2025-08-08 02:29:01,865 | INFO     | train - E051  train:5.210e-04  val:8.404e-05  lr:9.41e-05  t:125.1s
2025-08-08 02:31:07,220 | INFO     | train - E052  train:8.033e-05  val:6.872e-05  lr:9.39e-05  t:125.3s
2025-08-08 02:33:12,611 | INFO     | train - E053  train:8.484e-05  val:6.789e-05  lr:9.36e-05  t:125.4s
2025-08-08 02:35:17,871 | INFO     | train - E054  train:1.505e-03  val:9.005e-05  lr:9.33e-05  t:125.2s
2025-08-08 02:37:23,114 | INFO     | train - E055  train:7.206e-05  val:8.580e-05  lr:9.31e-05  t:125.2s
2025-08-08 02:39:28,291 | INFO     | train - E056  train:1.729e-04  val:6.679e-05  lr:9.28e-05  t:125.1s
2025-08-08 02:41:33,635 | INFO     | train - E057  train:7.305e-05  val:9.763e-05  lr:9.25e-05  t:125.3s
2025-08-08 02:43:38,964 | INFO     | train - E058  train:3.505e-04  val:5.230e-05  lr:9.22e-05  t:125.3s
2025-08-08 02:45:44,209 | INFO     | train - E059  train:5.970e-05  val:6.212e-05  lr:9.20e-05  t:125.2s
2025-08-08 02:47:49,482 | INFO     | train - E060  train:2.675e-04  val:6.827e-05  lr:9.17e-05  t:125.2s
2025-08-08 02:49:54,954 | INFO     | train - E061  train:6.536e-05  val:1.754e-04  lr:9.14e-05  t:125.4s
2025-08-08 02:52:00,485 | INFO     | train - E062  train:7.029e-05  val:1.349e-04  lr:9.11e-05  t:125.5s
2025-08-08 02:54:06,090 | INFO     | train - E063  train:5.516e-04  val:1.424e-04  lr:9.08e-05  t:125.6s
2025-08-08 02:56:11,062 | INFO     | train - E064  train:4.179e-05  val:9.594e-05  lr:9.05e-05  t:124.9s
2025-08-08 02:58:16,299 | INFO     | train - E065  train:6.210e-05  val:5.965e-05  lr:9.01e-05  t:125.2s
2025-08-08 03:00:21,655 | INFO     | train - E066  train:6.367e-05  val:5.798e-05  lr:8.98e-05  t:125.3s
2025-08-08 03:02:26,797 | INFO     | train - E067  train:1.582e-04  val:4.178e-05  lr:8.95e-05  t:125.1s
2025-08-08 03:04:32,007 | INFO     | train - E068  train:5.734e-05  val:7.406e-05  lr:8.92e-05  t:125.2s
2025-08-08 03:06:37,409 | INFO     | train - E069  train:1.072e-04  val:3.815e-05  lr:8.88e-05  t:125.4s  ↓3.866e-07
2025-08-08 03:06:37,500 | INFO     | train - Saved best model (epoch 69).
2025-08-08 03:06:37,520 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 03:06:37,597 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 03:06:37,601 | INFO     | model - Model moved to device: cuda
2025-08-08 03:06:37,769 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 03:06:37,770 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 03:06:38,468 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 03:08:46,934 | INFO     | train - E070  train:5.029e-05  val:6.231e-05  lr:8.85e-05  t:128.3s
2025-08-08 03:10:52,450 | INFO     | train - E071  train:5.645e-05  val:8.133e-05  lr:8.82e-05  t:125.5s
2025-08-08 03:12:58,130 | INFO     | train - E072  train:1.895e-04  val:3.389e-05  lr:8.78e-05  t:125.6s  ↓4.262e-06
2025-08-08 03:12:58,219 | INFO     | train - Saved best model (epoch 72).
2025-08-08 03:12:58,240 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 03:12:58,318 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 03:12:58,323 | INFO     | model - Model moved to device: cuda
2025-08-08 03:12:58,442 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 03:12:58,442 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 03:12:59,594 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 03:15:07,960 | INFO     | train - E073  train:3.860e-05  val:4.403e-05  lr:8.75e-05  t:128.2s
2025-08-08 03:17:13,341 | INFO     | train - E074  train:5.089e-05  val:6.032e-05  lr:8.71e-05  t:125.3s
2025-08-08 03:19:18,544 | INFO     | train - E075  train:1.512e-04  val:4.985e-05  lr:8.67e-05  t:125.2s
2025-08-08 03:21:23,964 | INFO     | train - E076  train:4.822e-05  val:4.872e-05  lr:8.64e-05  t:125.4s
2025-08-08 03:23:29,481 | INFO     | train - E077  train:5.031e-05  val:5.468e-05  lr:8.60e-05  t:125.5s
2025-08-08 03:25:34,760 | INFO     | train - E078  train:1.125e-04  val:7.000e-05  lr:8.56e-05  t:125.2s
2025-08-08 03:27:40,165 | INFO     | train - E079  train:4.568e-05  val:4.059e-05  lr:8.53e-05  t:125.4s
2025-08-08 03:29:45,866 | INFO     | train - E080  train:4.835e-05  val:9.173e-05  lr:8.49e-05  t:125.7s
2025-08-08 03:31:51,514 | INFO     | train - E081  train:8.515e-05  val:2.764e-05  lr:8.45e-05  t:125.6s  ↓6.245e-06
2025-08-08 03:31:51,597 | INFO     | train - Saved best model (epoch 81).
2025-08-08 03:31:51,615 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 03:31:51,692 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 03:31:51,697 | INFO     | model - Model moved to device: cuda
2025-08-08 03:31:51,838 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 03:31:51,839 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 03:31:52,553 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 03:34:01,043 | INFO     | train - E082  train:3.512e-05  val:3.265e-05  lr:8.41e-05  t:128.3s
2025-08-08 03:36:06,504 | INFO     | train - E083  train:4.342e-05  val:5.247e-05  lr:8.37e-05  t:125.4s
2025-08-08 03:38:12,020 | INFO     | train - E084  train:4.327e-05  val:4.593e-05  lr:8.33e-05  t:125.5s
2025-08-08 03:40:17,697 | INFO     | train - E085  train:4.311e-05  val:4.360e-05  lr:8.29e-05  t:125.6s
2025-08-08 03:42:23,209 | INFO     | train - E086  train:5.634e-05  val:3.957e-05  lr:8.25e-05  t:125.5s
2025-08-08 03:44:28,877 | INFO     | train - E087  train:3.911e-05  val:4.034e-05  lr:8.21e-05  t:125.6s
2025-08-08 03:46:34,492 | INFO     | train - E088  train:6.090e-05  val:2.299e-05  lr:8.17e-05  t:125.6s  ↓4.652e-06
2025-08-08 03:46:34,575 | INFO     | train - Saved best model (epoch 88).
2025-08-08 03:46:34,590 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 03:46:34,665 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 03:46:34,670 | INFO     | model - Model moved to device: cuda
2025-08-08 03:46:34,794 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 03:46:34,795 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 03:46:35,499 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 03:48:44,050 | INFO     | train - E089  train:3.200e-05  val:4.255e-05  lr:8.13e-05  t:128.3s
2025-08-08 03:50:49,598 | INFO     | train - E090  train:3.804e-05  val:3.821e-05  lr:8.09e-05  t:125.5s
2025-08-08 03:52:55,428 | INFO     | train - E091  train:3.830e-05  val:1.205e-04  lr:8.05e-05  t:125.8s
2025-08-08 03:55:01,395 | INFO     | train - E092  train:3.865e-05  val:3.784e-05  lr:8.00e-05  t:125.9s
2025-08-08 03:57:07,290 | INFO     | train - E093  train:3.589e-05  val:2.951e-05  lr:7.96e-05  t:125.9s
2025-08-08 03:59:13,023 | INFO     | train - E094  train:4.028e-05  val:2.674e-05  lr:7.92e-05  t:125.7s
2025-08-08 04:01:18,736 | INFO     | train - E095  train:3.395e-05  val:3.075e-05  lr:7.87e-05  t:125.7s
2025-08-08 04:03:24,594 | INFO     | train - E096  train:3.412e-05  val:3.428e-05  lr:7.83e-05  t:125.8s
2025-08-08 04:05:30,255 | INFO     | train - E097  train:3.337e-05  val:5.581e-05  lr:7.79e-05  t:125.6s
2025-08-08 04:07:36,086 | INFO     | train - E098  train:3.307e-05  val:1.309e-04  lr:7.74e-05  t:125.8s
2025-08-08 04:09:41,970 | INFO     | train - E099  train:3.184e-05  val:3.352e-05  lr:7.70e-05  t:125.8s
2025-08-08 04:11:47,825 | INFO     | train - E100  train:3.140e-05  val:2.668e-05  lr:7.65e-05  t:125.8s
2025-08-08 04:13:53,611 | INFO     | train - E101  train:3.110e-05  val:2.771e-05  lr:7.61e-05  t:125.7s
2025-08-08 04:15:59,322 | INFO     | train - E102  train:4.171e-05  val:9.223e-04  lr:7.56e-05  t:125.7s
2025-08-08 04:18:04,659 | INFO     | train - E103  train:2.537e-05  val:2.795e-05  lr:7.52e-05  t:125.3s
2025-08-08 04:20:10,209 | INFO     | train - E104  train:2.846e-05  val:2.657e-05  lr:7.47e-05  t:125.5s
2025-08-08 04:22:15,793 | INFO     | train - E105  train:2.872e-05  val:2.682e-05  lr:7.42e-05  t:125.5s
2025-08-08 04:24:21,464 | INFO     | train - E106  train:2.797e-05  val:3.348e-05  lr:7.38e-05  t:125.6s
2025-08-08 04:26:27,183 | INFO     | train - E107  train:2.726e-05  val:2.896e-05  lr:7.33e-05  t:125.7s
2025-08-08 04:28:32,823 | INFO     | train - E108  train:2.674e-05  val:2.571e-05  lr:7.28e-05  t:125.6s
2025-08-08 04:30:38,457 | INFO     | train - E109  train:2.662e-05  val:2.755e-05  lr:7.23e-05  t:125.6s
2025-08-08 04:32:44,136 | INFO     | train - E110  train:2.619e-05  val:3.613e-05  lr:7.19e-05  t:125.6s
2025-08-08 04:34:49,989 | INFO     | train - E111  train:2.553e-05  val:2.841e-05  lr:7.14e-05  t:125.8s
2025-08-08 04:36:55,702 | INFO     | train - E112  train:2.459e-05  val:5.332e-05  lr:7.09e-05  t:125.7s
2025-08-08 04:39:01,099 | INFO     | train - E113  train:3.514e-05  val:2.032e-05  lr:7.04e-05  t:125.4s  ↓2.674e-06
2025-08-08 04:39:01,181 | INFO     | train - Saved best model (epoch 113).
2025-08-08 04:39:01,203 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 04:39:01,280 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 04:39:01,285 | INFO     | model - Model moved to device: cuda
2025-08-08 04:39:01,475 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 04:39:01,485 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 04:39:02,186 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 04:41:10,604 | INFO     | train - E114  train:2.219e-05  val:2.652e-05  lr:6.99e-05  t:128.2s
2025-08-08 04:43:16,003 | INFO     | train - E115  train:2.268e-05  val:2.418e-05  lr:6.94e-05  t:125.4s
2025-08-08 04:45:21,770 | INFO     | train - E116  train:2.294e-05  val:2.222e-05  lr:6.90e-05  t:125.7s
2025-08-08 04:47:27,617 | INFO     | train - E117  train:2.223e-05  val:2.664e-05  lr:6.85e-05  t:125.8s
2025-08-08 04:49:33,422 | INFO     | train - E118  train:2.214e-05  val:2.031e-05  lr:6.80e-05  t:125.8s  ↓7.862e-09
2025-08-08 04:49:33,519 | INFO     | train - Saved best model (epoch 118).
2025-08-08 04:49:33,541 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 04:49:33,618 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 04:49:33,622 | INFO     | model - Model moved to device: cuda
2025-08-08 04:49:33,726 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 04:49:33,726 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 04:49:34,902 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 04:51:43,392 | INFO     | train - E119  train:2.153e-05  val:2.651e-05  lr:6.75e-05  t:128.3s
2025-08-08 04:53:49,023 | INFO     | train - E120  train:2.167e-05  val:2.200e-05  lr:6.70e-05  t:125.6s
2025-08-08 04:55:54,866 | INFO     | train - E121  train:2.056e-05  val:2.113e-05  lr:6.65e-05  t:125.8s
2025-08-08 04:58:00,547 | INFO     | train - E122  train:2.030e-05  val:2.811e-05  lr:6.60e-05  t:125.6s
2025-08-08 05:00:06,426 | INFO     | train - E123  train:1.998e-05  val:3.272e-05  lr:6.55e-05  t:125.8s
2025-08-08 05:02:12,237 | INFO     | train - E124  train:1.981e-05  val:1.592e-05  lr:6.49e-05  t:125.8s  ↓4.394e-06
2025-08-08 05:02:12,318 | INFO     | train - Saved best model (epoch 124).
2025-08-08 05:02:12,333 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 05:02:12,410 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 05:02:12,415 | INFO     | model - Model moved to device: cuda
2025-08-08 05:02:12,517 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 05:02:12,517 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 05:02:13,234 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 05:04:21,858 | INFO     | train - E125  train:1.992e-05  val:1.767e-05  lr:6.44e-05  t:128.4s
2025-08-08 05:06:27,399 | INFO     | train - E126  train:1.859e-05  val:2.494e-05  lr:6.39e-05  t:125.5s
2025-08-08 05:08:33,057 | INFO     | train - E127  train:1.961e-05  val:2.033e-05  lr:6.34e-05  t:125.6s
2025-08-08 05:10:38,773 | INFO     | train - E128  train:1.817e-05  val:3.119e-05  lr:6.29e-05  t:125.7s
2025-08-08 05:12:44,569 | INFO     | train - E129  train:1.845e-05  val:1.689e-05  lr:6.24e-05  t:125.8s
2025-08-08 05:14:50,352 | INFO     | train - E130  train:1.748e-05  val:1.555e-05  lr:6.19e-05  t:125.7s  ↓3.687e-07
2025-08-08 05:14:50,432 | INFO     | train - Saved best model (epoch 130).
2025-08-08 05:14:50,452 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 05:14:50,528 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 05:14:50,533 | INFO     | model - Model moved to device: cuda
2025-08-08 05:14:50,638 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 05:14:50,638 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 05:14:51,344 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 05:16:59,942 | INFO     | train - E131  train:1.748e-05  val:2.230e-05  lr:6.14e-05  t:128.4s
2025-08-08 05:19:05,484 | INFO     | train - E132  train:1.774e-05  val:1.539e-05  lr:6.08e-05  t:125.5s  ↓1.588e-07
2025-08-08 05:19:05,569 | INFO     | train - Saved best model (epoch 132).
2025-08-08 05:19:05,587 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 05:19:05,667 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 05:19:05,672 | INFO     | model - Model moved to device: cuda
2025-08-08 05:19:05,774 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 05:19:05,774 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 05:19:06,477 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 05:21:15,066 | INFO     | train - E133  train:1.661e-05  val:1.953e-05  lr:6.03e-05  t:128.4s
2025-08-08 05:23:20,584 | INFO     | train - E134  train:1.640e-05  val:1.413e-05  lr:5.98e-05  t:125.5s  ↓1.260e-06
2025-08-08 05:23:20,656 | INFO     | train - Saved best model (epoch 134).
2025-08-08 05:23:20,678 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 05:23:20,757 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 05:23:20,762 | INFO     | model - Model moved to device: cuda
2025-08-08 05:23:20,862 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 05:23:20,863 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 05:23:22,077 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 05:25:30,193 | INFO     | train - E135  train:1.632e-05  val:1.481e-05  lr:5.93e-05  t:127.9s
2025-08-08 05:27:35,711 | INFO     | train - E136  train:1.596e-05  val:1.946e-05  lr:5.87e-05  t:125.5s
2025-08-08 05:29:41,375 | INFO     | train - E137  train:1.555e-05  val:2.724e-05  lr:5.82e-05  t:125.6s
2025-08-08 05:31:47,209 | INFO     | train - E138  train:1.535e-05  val:1.667e-05  lr:5.77e-05  t:125.8s
2025-08-08 05:33:53,081 | INFO     | train - E139  train:1.527e-05  val:2.081e-05  lr:5.72e-05  t:125.8s
2025-08-08 05:35:58,720 | INFO     | train - E140  train:1.504e-05  val:1.960e-05  lr:5.66e-05  t:125.6s
2025-08-08 05:38:04,498 | INFO     | train - E141  train:1.449e-05  val:2.330e-05  lr:5.61e-05  t:125.7s
2025-08-08 05:40:10,208 | INFO     | train - E142  train:1.484e-05  val:2.873e-05  lr:5.56e-05  t:125.7s
2025-08-08 05:42:15,942 | INFO     | train - E143  train:1.413e-05  val:2.184e-05  lr:5.51e-05  t:125.7s
2025-08-08 05:44:21,626 | INFO     | train - E144  train:1.358e-05  val:2.449e-05  lr:5.45e-05  t:125.6s
2025-08-08 05:46:27,426 | INFO     | train - E145  train:1.343e-05  val:1.721e-05  lr:5.40e-05  t:125.8s
2025-08-08 05:48:33,172 | INFO     | train - E146  train:1.365e-05  val:2.415e-05  lr:5.35e-05  t:125.7s
2025-08-08 05:50:39,012 | INFO     | train - E147  train:1.314e-05  val:1.426e-05  lr:5.29e-05  t:125.8s
2025-08-08 05:52:44,830 | INFO     | train - E148  train:1.298e-05  val:1.395e-05  lr:5.24e-05  t:125.8s  ↓1.824e-07
2025-08-08 05:52:44,909 | INFO     | train - Saved best model (epoch 148).
2025-08-08 05:52:44,927 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 05:52:45,006 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 05:52:45,011 | INFO     | model - Model moved to device: cuda
2025-08-08 05:52:45,179 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 05:52:45,179 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 05:52:46,380 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 05:54:54,923 | INFO     | train - E149  train:1.259e-05  val:1.350e-05  lr:5.19e-05  t:128.3s  ↓4.473e-07
2025-08-08 05:54:55,000 | INFO     | train - Saved best model (epoch 149).
2025-08-08 05:54:55,020 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 05:54:55,096 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 05:54:55,101 | INFO     | model - Model moved to device: cuda
2025-08-08 05:54:55,196 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 05:54:55,196 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 05:54:55,901 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 05:57:04,479 | INFO     | train - E150  train:1.311e-05  val:1.589e-05  lr:5.13e-05  t:128.4s
2025-08-08 05:59:10,083 | INFO     | train - E151  train:1.180e-05  val:1.542e-05  lr:5.08e-05  t:125.6s
2025-08-08 06:01:15,908 | INFO     | train - E152  train:1.217e-05  val:2.543e-05  lr:5.03e-05  t:125.8s
2025-08-08 06:03:21,793 | INFO     | train - E153  train:1.137e-05  val:1.657e-05  lr:4.97e-05  t:125.8s
2025-08-08 06:05:27,612 | INFO     | train - E154  train:1.184e-05  val:1.196e-05  lr:4.92e-05  t:125.8s  ↓1.537e-06
2025-08-08 06:05:27,697 | INFO     | train - Saved best model (epoch 154).
2025-08-08 06:05:27,717 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 06:05:27,801 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 06:05:27,806 | INFO     | model - Model moved to device: cuda
2025-08-08 06:05:27,911 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 06:05:27,911 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 06:05:28,623 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 06:07:37,225 | INFO     | train - E155  train:1.127e-05  val:1.167e-05  lr:4.87e-05  t:128.4s  ↓2.943e-07
2025-08-08 06:07:37,302 | INFO     | train - Saved best model (epoch 155).
2025-08-08 06:07:37,322 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 06:07:37,399 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 06:07:37,404 | INFO     | model - Model moved to device: cuda
2025-08-08 06:07:37,503 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 06:07:37,503 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 06:07:38,210 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 06:09:46,855 | INFO     | train - E156  train:1.124e-05  val:1.344e-05  lr:4.81e-05  t:128.4s
2025-08-08 06:11:52,455 | INFO     | train - E157  train:1.136e-05  val:1.436e-05  lr:4.76e-05  t:125.6s
2025-08-08 06:13:58,331 | INFO     | train - E158  train:1.109e-05  val:1.205e-05  lr:4.71e-05  t:125.8s
2025-08-08 06:16:04,062 | INFO     | train - E159  train:1.048e-05  val:9.172e-06  lr:4.65e-05  t:125.7s  ↓2.495e-06
2025-08-08 06:16:04,149 | INFO     | train - Saved best model (epoch 159).
2025-08-08 06:16:04,172 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 06:16:04,247 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 06:16:04,252 | INFO     | model - Model moved to device: cuda
2025-08-08 06:16:04,356 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 06:16:04,357 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 06:16:05,065 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 06:18:13,756 | INFO     | train - E160  train:1.083e-05  val:8.721e-06  lr:4.60e-05  t:128.5s  ↓4.514e-07
2025-08-08 06:18:13,822 | INFO     | train - Saved best model (epoch 160).
2025-08-08 06:18:13,843 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 06:18:13,920 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 06:18:13,925 | INFO     | model - Model moved to device: cuda
2025-08-08 06:18:14,021 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 06:18:14,021 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 06:18:14,731 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 06:20:23,452 | INFO     | train - E161  train:1.008e-05  val:1.183e-05  lr:4.55e-05  t:128.5s
2025-08-08 06:22:28,991 | INFO     | train - E162  train:9.864e-06  val:1.492e-05  lr:4.50e-05  t:125.5s
2025-08-08 06:24:34,630 | INFO     | train - E163  train:1.018e-05  val:1.206e-05  lr:4.44e-05  t:125.6s
2025-08-08 06:26:40,258 | INFO     | train - E164  train:9.931e-06  val:1.605e-05  lr:4.39e-05  t:125.6s
2025-08-08 06:28:45,987 | INFO     | train - E165  train:9.437e-06  val:1.255e-05  lr:4.34e-05  t:125.7s
2025-08-08 06:30:51,665 | INFO     | train - E166  train:9.801e-06  val:1.274e-05  lr:4.28e-05  t:125.6s
2025-08-08 06:32:57,308 | INFO     | train - E167  train:9.091e-06  val:1.112e-05  lr:4.23e-05  t:125.6s
2025-08-08 06:35:02,931 | INFO     | train - E168  train:9.510e-06  val:1.255e-05  lr:4.18e-05  t:125.6s
2025-08-08 06:37:08,660 | INFO     | train - E169  train:9.019e-06  val:9.052e-06  lr:4.13e-05  t:125.7s
2025-08-08 06:39:14,646 | INFO     | train - E170  train:8.897e-06  val:1.363e-05  lr:4.07e-05  t:125.9s
2025-08-08 06:41:20,506 | INFO     | train - E171  train:8.565e-06  val:1.130e-05  lr:4.02e-05  t:125.8s
2025-08-08 06:43:26,382 | INFO     | train - E172  train:8.694e-06  val:1.262e-05  lr:3.97e-05  t:125.8s
2025-08-08 06:45:32,312 | INFO     | train - E173  train:8.655e-06  val:1.093e-05  lr:3.92e-05  t:125.9s
2025-08-08 06:47:38,022 | INFO     | train - E174  train:7.996e-06  val:8.916e-06  lr:3.87e-05  t:125.7s
2025-08-08 06:49:43,924 | INFO     | train - E175  train:8.396e-06  val:1.251e-05  lr:3.81e-05  t:125.9s
2025-08-08 06:51:49,723 | INFO     | train - E176  train:7.798e-06  val:9.748e-06  lr:3.76e-05  t:125.8s
2025-08-08 06:53:55,445 | INFO     | train - E177  train:8.129e-06  val:9.385e-06  lr:3.71e-05  t:125.7s
2025-08-08 06:56:01,244 | INFO     | train - E178  train:7.806e-06  val:9.394e-06  lr:3.66e-05  t:125.8s
2025-08-08 06:58:07,087 | INFO     | train - E179  train:7.444e-06  val:1.116e-05  lr:3.61e-05  t:125.8s
2025-08-08 07:00:12,902 | INFO     | train - E180  train:7.440e-06  val:9.270e-06  lr:3.56e-05  t:125.8s
2025-08-08 07:02:18,955 | INFO     | train - E181  train:7.205e-06  val:8.501e-06  lr:3.51e-05  t:126.0s  ↓2.195e-07
2025-08-08 07:02:19,044 | INFO     | train - Saved best model (epoch 181).
2025-08-08 07:02:19,065 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 07:02:19,143 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 07:02:19,148 | INFO     | model - Model moved to device: cuda
2025-08-08 07:02:19,317 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 07:02:19,317 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 07:02:20,027 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 07:04:28,736 | INFO     | train - E182  train:7.364e-06  val:8.870e-06  lr:3.46e-05  t:128.5s
2025-08-08 07:06:34,332 | INFO     | train - E183  train:7.166e-06  val:7.227e-06  lr:3.41e-05  t:125.6s  ↓1.274e-06
2025-08-08 07:06:34,410 | INFO     | train - Saved best model (epoch 183).
2025-08-08 07:06:34,431 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 07:06:34,508 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 07:06:34,513 | INFO     | model - Model moved to device: cuda
2025-08-08 07:06:34,616 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 07:06:34,617 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 07:06:35,320 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 07:08:44,024 | INFO     | train - E184  train:7.247e-06  val:1.263e-05  lr:3.35e-05  t:128.5s
2025-08-08 07:10:49,653 | INFO     | train - E185  train:6.901e-06  val:1.299e-05  lr:3.30e-05  t:125.6s
2025-08-08 07:12:55,445 | INFO     | train - E186  train:6.850e-06  val:9.862e-06  lr:3.25e-05  t:125.8s
2025-08-08 07:15:01,183 | INFO     | train - E187  train:6.727e-06  val:8.372e-06  lr:3.20e-05  t:125.7s
2025-08-08 07:17:06,921 | INFO     | train - E188  train:6.721e-06  val:7.852e-06  lr:3.16e-05  t:125.7s
2025-08-08 07:19:12,627 | INFO     | train - E189  train:6.650e-06  val:9.665e-06  lr:3.11e-05  t:125.7s
2025-08-08 07:21:18,406 | INFO     | train - E190  train:6.401e-06  val:8.024e-06  lr:3.06e-05  t:125.7s
2025-08-08 07:23:24,272 | INFO     | train - E191  train:6.352e-06  val:1.050e-05  lr:3.01e-05  t:125.8s
2025-08-08 07:25:30,095 | INFO     | train - E192  train:6.271e-06  val:7.358e-06  lr:2.96e-05  t:125.8s
2025-08-08 07:27:35,799 | INFO     | train - E193  train:6.132e-06  val:1.042e-05  lr:2.91e-05  t:125.7s
2025-08-08 07:29:41,491 | INFO     | train - E194  train:6.316e-06  val:7.620e-06  lr:2.86e-05  t:125.6s
2025-08-08 07:31:47,252 | INFO     | train - E195  train:6.117e-06  val:7.369e-06  lr:2.81e-05  t:125.7s
2025-08-08 07:33:52,981 | INFO     | train - E196  train:6.122e-06  val:1.049e-05  lr:2.77e-05  t:125.7s
2025-08-08 07:35:58,705 | INFO     | train - E197  train:5.931e-06  val:8.396e-06  lr:2.72e-05  t:125.7s
2025-08-08 07:38:04,535 | INFO     | train - E198  train:5.832e-06  val:7.964e-06  lr:2.67e-05  t:125.8s
2025-08-08 07:40:10,278 | INFO     | train - E199  train:5.731e-06  val:8.868e-06  lr:2.62e-05  t:125.7s
2025-08-08 07:42:16,074 | INFO     | train - E200  train:5.725e-06  val:7.238e-06  lr:2.58e-05  t:125.8s
2025-08-08 07:44:21,867 | INFO     | train - E201  train:5.759e-06  val:7.683e-06  lr:2.53e-05  t:125.8s
2025-08-08 07:46:27,547 | INFO     | train - E202  train:5.517e-06  val:7.616e-06  lr:2.49e-05  t:125.6s
2025-08-08 07:48:33,264 | INFO     | train - E203  train:5.347e-06  val:8.795e-06  lr:2.44e-05  t:125.7s
2025-08-08 07:50:39,120 | INFO     | train - E204  train:5.261e-06  val:7.463e-06  lr:2.39e-05  t:125.8s
2025-08-08 07:52:44,914 | INFO     | train - E205  train:5.308e-06  val:7.863e-06  lr:2.35e-05  t:125.7s
2025-08-08 07:54:50,893 | INFO     | train - E206  train:5.208e-06  val:7.275e-06  lr:2.30e-05  t:125.9s
2025-08-08 07:56:56,603 | INFO     | train - E207  train:4.996e-06  val:7.406e-06  lr:2.26e-05  t:125.7s
2025-08-08 07:59:02,350 | INFO     | train - E208  train:5.187e-06  val:6.743e-06  lr:2.21e-05  t:125.7s  ↓4.838e-07
2025-08-08 07:59:02,433 | INFO     | train - Saved best model (epoch 208).
2025-08-08 07:59:02,448 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 07:59:02,525 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 07:59:02,530 | INFO     | model - Model moved to device: cuda
2025-08-08 07:59:02,642 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 07:59:02,642 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 07:59:03,357 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 08:01:12,105 | INFO     | train - E209  train:4.959e-06  val:7.593e-06  lr:2.17e-05  t:128.5s
2025-08-08 08:03:17,840 | INFO     | train - E210  train:5.000e-06  val:7.145e-06  lr:2.13e-05  t:125.7s
2025-08-08 08:05:23,804 | INFO     | train - E211  train:4.917e-06  val:7.228e-06  lr:2.08e-05  t:125.9s
2025-08-08 08:07:29,548 | INFO     | train - E212  train:4.894e-06  val:7.608e-06  lr:2.04e-05  t:125.7s
2025-08-08 08:09:35,243 | INFO     | train - E213  train:4.772e-06  val:6.524e-06  lr:2.00e-05  t:125.7s  ↓2.190e-07
2025-08-08 08:09:35,360 | INFO     | train - Saved best model (epoch 213).
2025-08-08 08:09:35,375 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 08:09:35,451 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 08:09:35,456 | INFO     | model - Model moved to device: cuda
2025-08-08 08:09:35,619 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 08:09:35,631 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 08:09:36,343 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 08:11:45,071 | INFO     | train - E214  train:4.719e-06  val:6.592e-06  lr:1.96e-05  t:128.5s
2025-08-08 08:13:50,650 | INFO     | train - E215  train:4.665e-06  val:7.175e-06  lr:1.91e-05  t:125.5s
2025-08-08 08:15:56,441 | INFO     | train - E216  train:4.689e-06  val:6.308e-06  lr:1.87e-05  t:125.7s  ↓2.167e-07
2025-08-08 08:15:56,520 | INFO     | train - Saved best model (epoch 216).
2025-08-08 08:15:56,541 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 08:15:56,619 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 08:15:56,623 | INFO     | model - Model moved to device: cuda
2025-08-08 08:15:56,727 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 08:15:56,727 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 08:15:57,440 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 08:18:06,171 | INFO     | train - E217  train:4.531e-06  val:6.154e-06  lr:1.83e-05  t:128.5s  ↓1.537e-07
2025-08-08 08:18:06,255 | INFO     | train - Saved best model (epoch 217).
2025-08-08 08:18:06,269 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 08:18:06,346 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 08:18:06,351 | INFO     | model - Model moved to device: cuda
2025-08-08 08:18:06,442 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 08:18:06,442 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 08:18:07,143 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 08:20:15,872 | INFO     | train - E218  train:4.356e-06  val:8.002e-06  lr:1.79e-05  t:128.5s
2025-08-08 08:22:21,451 | INFO     | train - E219  train:4.472e-06  val:7.296e-06  lr:1.75e-05  t:125.5s
2025-08-08 08:24:27,131 | INFO     | train - E220  train:4.475e-06  val:6.387e-06  lr:1.71e-05  t:125.6s
2025-08-08 08:26:32,890 | INFO     | train - E221  train:4.415e-06  val:6.382e-06  lr:1.67e-05  t:125.7s
2025-08-08 08:28:38,747 | INFO     | train - E222  train:4.236e-06  val:7.569e-06  lr:1.63e-05  t:125.8s
2025-08-08 08:30:44,545 | INFO     | train - E223  train:4.301e-06  val:8.685e-06  lr:1.59e-05  t:125.8s
2025-08-08 08:32:50,316 | INFO     | train - E224  train:4.273e-06  val:6.385e-06  lr:1.55e-05  t:125.7s
2025-08-08 08:34:56,211 | INFO     | train - E225  train:4.143e-06  val:6.540e-06  lr:1.51e-05  t:125.9s
2025-08-08 08:37:01,925 | INFO     | train - E226  train:4.045e-06  val:7.336e-06  lr:1.47e-05  t:125.7s
2025-08-08 08:39:07,622 | INFO     | train - E227  train:4.230e-06  val:7.531e-06  lr:1.44e-05  t:125.7s
2025-08-08 08:41:13,465 | INFO     | train - E228  train:4.279e-06  val:7.053e-06  lr:1.40e-05  t:125.8s
2025-08-08 08:43:19,201 | INFO     | train - E229  train:4.202e-06  val:5.993e-06  lr:1.36e-05  t:125.7s  ↓1.609e-07
2025-08-08 08:43:19,301 | INFO     | train - Saved best model (epoch 229).
2025-08-08 08:43:19,320 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 08:43:19,397 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 08:43:19,402 | INFO     | model - Model moved to device: cuda
2025-08-08 08:43:19,508 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 08:43:19,508 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 08:43:20,218 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 08:45:28,986 | INFO     | train - E230  train:4.160e-06  val:6.254e-06  lr:1.33e-05  t:128.6s
2025-08-08 08:47:34,482 | INFO     | train - E231  train:4.058e-06  val:6.975e-06  lr:1.29e-05  t:125.5s
2025-08-08 08:49:40,348 | INFO     | train - E232  train:4.132e-06  val:6.076e-06  lr:1.26e-05  t:125.8s
2025-08-08 08:51:46,147 | INFO     | train - E233  train:3.965e-06  val:6.144e-06  lr:1.22e-05  t:125.8s
2025-08-08 08:53:51,961 | INFO     | train - E234  train:3.960e-06  val:6.094e-06  lr:1.19e-05  t:125.8s
2025-08-08 08:55:57,658 | INFO     | train - E235  train:3.827e-06  val:6.246e-06  lr:1.15e-05  t:125.7s
2025-08-08 08:58:03,409 | INFO     | train - E236  train:3.962e-06  val:6.320e-06  lr:1.12e-05  t:125.7s
2025-08-08 09:00:09,142 | INFO     | train - E237  train:3.828e-06  val:6.599e-06  lr:1.08e-05  t:125.7s
2025-08-08 09:02:14,909 | INFO     | train - E238  train:3.839e-06  val:6.215e-06  lr:1.05e-05  t:125.7s
2025-08-08 09:04:20,583 | INFO     | train - E239  train:3.715e-06  val:5.813e-06  lr:1.02e-05  t:125.6s  ↓1.800e-07
2025-08-08 09:04:20,642 | INFO     | train - Saved best model (epoch 239).
2025-08-08 09:04:20,657 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 09:04:20,733 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 09:04:20,738 | INFO     | model - Model moved to device: cuda
2025-08-08 09:04:20,863 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 09:04:20,863 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 09:04:21,583 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 09:06:29,911 | INFO     | train - E240  train:3.758e-06  val:5.853e-06  lr:9.87e-06  t:128.1s
2025-08-08 09:08:35,658 | INFO     | train - E241  train:3.754e-06  val:5.788e-06  lr:9.56e-06  t:125.7s  ↓2.549e-08
2025-08-08 09:08:35,740 | INFO     | train - Saved best model (epoch 241).
2025-08-08 09:08:35,751 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 09:08:35,830 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 09:08:35,834 | INFO     | model - Model moved to device: cuda
2025-08-08 09:08:36,006 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 09:08:36,006 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 09:08:37,291 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 09:10:45,575 | INFO     | train - E242  train:3.640e-06  val:5.601e-06  lr:9.25e-06  t:128.1s  ↓1.871e-07
2025-08-08 09:10:45,654 | INFO     | train - Saved best model (epoch 242).
2025-08-08 09:10:45,673 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 09:10:45,748 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 09:10:45,753 | INFO     | model - Model moved to device: cuda
2025-08-08 09:10:45,846 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 09:10:45,846 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 09:10:46,536 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 09:12:55,284 | INFO     | train - E243  train:3.705e-06  val:5.841e-06  lr:8.94e-06  t:128.5s
2025-08-08 09:15:00,972 | INFO     | train - E244  train:3.645e-06  val:5.879e-06  lr:8.64e-06  t:125.7s
2025-08-08 09:17:06,824 | INFO     | train - E245  train:3.592e-06  val:6.156e-06  lr:8.34e-06  t:125.8s
2025-08-08 09:19:12,604 | INFO     | train - E246  train:3.651e-06  val:6.245e-06  lr:8.05e-06  t:125.7s
2025-08-08 09:21:18,447 | INFO     | train - E247  train:3.692e-06  val:5.712e-06  lr:7.76e-06  t:125.8s
2025-08-08 09:23:24,260 | INFO     | train - E248  train:3.621e-06  val:5.713e-06  lr:7.48e-06  t:125.8s
2025-08-08 09:25:30,006 | INFO     | train - E249  train:3.561e-06  val:5.875e-06  lr:7.20e-06  t:125.7s
2025-08-08 09:27:35,974 | INFO     | train - E250  train:3.543e-06  val:5.846e-06  lr:6.93e-06  t:125.9s
2025-08-08 09:29:41,664 | INFO     | train - E251  train:3.554e-06  val:5.774e-06  lr:6.66e-06  t:125.6s
2025-08-08 09:31:47,483 | INFO     | train - E252  train:3.528e-06  val:5.630e-06  lr:6.40e-06  t:125.8s
2025-08-08 09:33:53,202 | INFO     | train - E253  train:3.507e-06  val:6.326e-06  lr:6.14e-06  t:125.7s
2025-08-08 09:35:59,083 | INFO     | train - E254  train:3.457e-06  val:5.668e-06  lr:5.89e-06  t:125.9s
2025-08-08 09:38:04,945 | INFO     | train - E255  train:3.434e-06  val:5.599e-06  lr:5.64e-06  t:125.8s  ↓1.839e-09
2025-08-08 09:38:05,026 | INFO     | train - Saved best model (epoch 255).
2025-08-08 09:38:05,047 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 09:38:05,123 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 09:38:05,128 | INFO     | model - Model moved to device: cuda
2025-08-08 09:38:05,250 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 09:38:05,250 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 09:38:05,962 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 09:40:14,843 | INFO     | train - E256  train:3.366e-06  val:5.619e-06  lr:5.40e-06  t:128.7s
2025-08-08 09:42:20,407 | INFO     | train - E257  train:3.345e-06  val:5.422e-06  lr:5.16e-06  t:125.5s  ↓1.769e-07
2025-08-08 09:42:20,486 | INFO     | train - Saved best model (epoch 257).
2025-08-08 09:42:20,498 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 09:42:20,575 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 09:42:20,579 | INFO     | model - Model moved to device: cuda
2025-08-08 09:42:20,682 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 09:42:20,682 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 09:42:21,392 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 09:44:30,273 | INFO     | train - E258  train:3.381e-06  val:5.763e-06  lr:4.93e-06  t:128.7s
2025-08-08 09:46:35,707 | INFO     | train - E259  train:3.345e-06  val:5.573e-06  lr:4.70e-06  t:125.4s
2025-08-08 09:48:41,514 | INFO     | train - E260  train:3.231e-06  val:5.713e-06  lr:4.48e-06  t:125.8s
2025-08-08 09:50:47,359 | INFO     | train - E261  train:3.250e-06  val:5.527e-06  lr:4.26e-06  t:125.8s
2025-08-08 09:52:53,128 | INFO     | train - E262  train:3.236e-06  val:5.687e-06  lr:4.05e-06  t:125.7s
2025-08-08 09:54:58,706 | INFO     | train - E263  train:3.224e-06  val:5.811e-06  lr:3.84e-06  t:125.5s
2025-08-08 09:57:04,289 | INFO     | train - E264  train:3.241e-06  val:5.399e-06  lr:3.64e-06  t:125.5s  ↓2.324e-08
2025-08-08 09:57:04,377 | INFO     | train - Saved best model (epoch 264).
2025-08-08 09:57:04,399 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 09:57:04,476 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 09:57:04,481 | INFO     | model - Model moved to device: cuda
2025-08-08 09:57:04,586 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 09:57:04,586 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 09:57:05,304 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 09:59:13,657 | INFO     | train - E265  train:3.133e-06  val:5.535e-06  lr:3.44e-06  t:128.1s
2025-08-08 10:01:19,043 | INFO     | train - E266  train:3.190e-06  val:5.374e-06  lr:3.25e-06  t:125.4s  ↓2.473e-08
2025-08-08 10:01:19,119 | INFO     | train - Saved best model (epoch 266).
2025-08-08 10:01:19,137 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 10:01:19,213 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 10:01:19,218 | INFO     | model - Model moved to device: cuda
2025-08-08 10:01:19,320 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 10:01:19,329 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 10:01:20,664 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 10:03:28,939 | INFO     | train - E267  train:3.146e-06  val:5.376e-06  lr:3.07e-06  t:128.1s
2025-08-08 10:05:34,485 | INFO     | train - E268  train:3.118e-06  val:5.330e-06  lr:2.89e-06  t:125.5s  ↓4.409e-08
2025-08-08 10:05:34,573 | INFO     | train - Saved best model (epoch 268).
2025-08-08 10:05:34,592 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 10:05:34,668 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 10:05:34,673 | INFO     | model - Model moved to device: cuda
2025-08-08 10:05:34,793 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 10:05:34,793 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 10:05:35,490 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 10:07:44,398 | INFO     | train - E269  train:3.086e-06  val:5.360e-06  lr:2.71e-06  t:128.7s
2025-08-08 10:09:49,966 | INFO     | train - E270  train:3.064e-06  val:5.620e-06  lr:2.54e-06  t:125.5s
2025-08-08 10:11:55,676 | INFO     | train - E271  train:3.029e-06  val:5.524e-06  lr:2.38e-06  t:125.7s
2025-08-08 10:14:01,407 | INFO     | train - E272  train:3.032e-06  val:5.397e-06  lr:2.22e-06  t:125.7s
2025-08-08 10:16:07,220 | INFO     | train - E273  train:3.008e-06  val:5.217e-06  lr:2.06e-06  t:125.8s  ↓1.123e-07
2025-08-08 10:16:07,324 | INFO     | train - Saved best model (epoch 273).
2025-08-08 10:16:07,344 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 10:16:07,419 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 10:16:07,424 | INFO     | model - Model moved to device: cuda
2025-08-08 10:16:07,589 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 10:16:07,589 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 10:16:08,296 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 10:18:17,209 | INFO     | train - E274  train:2.978e-06  val:5.314e-06  lr:1.91e-06  t:128.7s
2025-08-08 10:20:22,515 | INFO     | train - E275  train:2.950e-06  val:5.301e-06  lr:1.77e-06  t:125.3s
2025-08-08 10:22:27,928 | INFO     | train - E276  train:2.945e-06  val:5.346e-06  lr:1.63e-06  t:125.4s
2025-08-08 10:24:33,544 | INFO     | train - E277  train:2.953e-06  val:5.269e-06  lr:1.50e-06  t:125.6s
2025-08-08 10:26:39,269 | INFO     | train - E278  train:2.944e-06  val:5.275e-06  lr:1.38e-06  t:125.7s
2025-08-08 10:28:44,917 | INFO     | train - E279  train:2.924e-06  val:5.334e-06  lr:1.26e-06  t:125.6s
2025-08-08 10:30:50,606 | INFO     | train - E280  train:2.920e-06  val:5.402e-06  lr:1.14e-06  t:125.7s
2025-08-08 10:32:56,345 | INFO     | train - E281  train:2.891e-06  val:5.330e-06  lr:1.03e-06  t:125.7s
2025-08-08 10:35:02,097 | INFO     | train - E282  train:2.881e-06  val:5.156e-06  lr:9.26e-07  t:125.7s  ↓6.171e-08
2025-08-08 10:35:02,172 | INFO     | train - Saved best model (epoch 282).
2025-08-08 10:35:02,184 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 10:35:02,262 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 10:35:02,266 | INFO     | model - Model moved to device: cuda
2025-08-08 10:35:02,372 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 10:35:02,372 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 10:35:03,085 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 10:37:11,389 | INFO     | train - E283  train:2.845e-06  val:5.257e-06  lr:8.27e-07  t:128.1s
2025-08-08 10:39:16,917 | INFO     | train - E284  train:2.857e-06  val:5.183e-06  lr:7.34e-07  t:125.5s
2025-08-08 10:41:22,418 | INFO     | train - E285  train:2.839e-06  val:5.150e-06  lr:6.47e-07  t:125.5s  ↓5.643e-09
2025-08-08 10:41:22,505 | INFO     | train - Saved best model (epoch 285).
2025-08-08 10:41:22,520 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 10:41:22,600 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 10:41:22,604 | INFO     | model - Model moved to device: cuda
2025-08-08 10:41:22,709 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 10:41:22,709 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 10:41:23,417 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 10:43:32,335 | INFO     | train - E286  train:2.821e-06  val:5.210e-06  lr:5.65e-07  t:128.7s
2025-08-08 10:45:37,936 | INFO     | train - E287  train:2.824e-06  val:5.199e-06  lr:4.88e-07  t:125.6s
2025-08-08 10:47:43,453 | INFO     | train - E288  train:2.834e-06  val:5.217e-06  lr:4.18e-07  t:125.5s
2025-08-08 10:49:49,054 | INFO     | train - E289  train:2.805e-06  val:5.243e-06  lr:3.53e-07  t:125.6s
2025-08-08 10:51:54,672 | INFO     | train - E290  train:2.805e-06  val:5.140e-06  lr:2.93e-07  t:125.6s  ↓9.937e-09
2025-08-08 10:51:54,718 | INFO     | train - Saved best model (epoch 290).
2025-08-08 10:51:54,730 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 10:51:54,808 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 10:51:54,813 | INFO     | model - Model moved to device: cuda
2025-08-08 10:51:54,918 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 10:51:54,919 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 10:51:55,632 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 10:54:04,612 | INFO     | train - E291  train:2.809e-06  val:5.123e-06  lr:2.39e-07  t:128.8s  ↓1.676e-08
2025-08-08 10:54:04,681 | INFO     | train - Saved best model (epoch 291).
2025-08-08 10:54:04,692 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 10:54:04,769 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 10:54:04,774 | INFO     | model - Model moved to device: cuda
2025-08-08 10:54:04,868 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 10:54:04,868 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 10:54:05,574 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 10:56:13,869 | INFO     | train - E292  train:2.797e-06  val:5.178e-06  lr:1.91e-07  t:128.1s
2025-08-08 10:58:19,345 | INFO     | train - E293  train:2.781e-06  val:5.165e-06  lr:1.49e-07  t:125.4s
2025-08-08 11:00:25,056 | INFO     | train - E294  train:2.788e-06  val:5.135e-06  lr:1.12e-07  t:125.7s
2025-08-08 11:02:30,817 | INFO     | train - E295  train:2.787e-06  val:5.183e-06  lr:8.09e-08  t:125.7s
2025-08-08 11:04:36,497 | INFO     | train - E296  train:2.788e-06  val:5.095e-06  lr:5.54e-08  t:125.7s  ↓2.810e-08
2025-08-08 11:04:36,541 | INFO     | train - Saved best model (epoch 296).
2025-08-08 11:04:36,559 | INFO     | train - Creating a fresh, un-compiled model instance for export.
2025-08-08 11:04:36,636 | INFO     | model - PredictionModel created with 9,731,586 trainable parameters. Architecture: d_model=512, nhead=4, layers=3
2025-08-08 11:04:36,640 | INFO     | model - Model moved to device: cuda
2025-08-08 11:04:36,744 | ERROR    | model - torch.export failed: unsupported operator: aten._transformer_encoder_layer_fwd.default (see https://docs.google.com/document/d/1GgvOe7C8_NVOMLOCwDaYV1mXXyHMXY7ExoewHqooxrs/edit#heading=h.64r4npvq0w0 for how to fix)

from user code:
   File "/gpfs/scratch/exoweather/imalsky/Problemulator/src/model.py", line 189, in forward
    x = layer(src=x, src_key_padding_mask=sequence_mask)

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information

2025-08-08 11:04:36,744 | INFO     | model - Attempting fallback export without dynamic shapes...
2025-08-08 11:04:38,095 | WARNING  | model - Exported with static shapes as fallback
2025-08-08 11:06:46,364 | INFO     | train - E297  train:2.791e-06  val:5.099e-06  lr:3.55e-08  t:128.1s
2025-08-08 11:08:51,816 | INFO     | train - E298  train:2.776e-06  val:5.104e-06  lr:2.13e-08  t:125.4s
2025-08-08 11:10:57,593 | INFO     | train - E299  train:2.757e-06  val:5.100e-06  lr:1.28e-08  t:125.8s
2025-08-08 11:13:03,390 | INFO     | train - E300  train:2.759e-06  val:5.097e-06  lr:1.00e-08  t:125.8s
2025-08-08 11:13:03,420 | INFO     | train - Done. Best val_loss=5.0953e-06 at epoch 296.
2025-08-08 11:13:12,195 | INFO     | train - Test loss: 5.0995e-06
2025-08-08 11:13:12,196 | INFO     | __main__ - Pipeline completed successfully.
